2023-03-21 14:29:38,825 - train - INFO - Log directory: ./model_saved/train/train-07
2023-03-21 14:29:38,827 - train - INFO - Args: {
    "cl_decay_steps": 3000,
    "cuda": true,
    "data_augment": true,
    "dcgru_activation": "tanh",
    "do_train": true,
    "dropout": 0.5,
    "eval_every": 1,
    "filter_type": "dual_random_walk",
    "fine_tune": false,
    "graph_type": "individual",
    "input_dim": 200,
    "input_dir": "../tusz_resampled/",
    "l2_wd": 0.0005,
    "load_model_path": null,
    "lr_init": 0.0003,
    "max_diffusion_step": 2,
    "max_grad_norm": 5.0,
    "max_seq_len": 12,
    "maximize_metric": true,
    "metric_avg": "weighted",
    "metric_name": "F1_macro",
    "model_name": "dcrnn",
    "num_classes": 4,
    "num_epochs": 60,
    "num_nodes": 19,
    "num_rnn_layers": 2,
    "num_workers": 8,
    "output_dim": 100,
    "output_seq_len": 12,
    "patience": 5,
    "preproc_dir": null,
    "preprocess": "raw_gamma",
    "pretrained_num_rnn_layers": 3,
    "rand_seed": 123,
    "raw_data_dir": "../tusz_raw/",
    "rnn_units": 64,
    "save_dir": "./model_saved/train/train-07",
    "task": "classification",
    "test_batch_size": 128,
    "time_step_size": 1,
    "top_k": 3,
    "train_batch_size": 40,
    "use_curriculum_learning": false
}
2023-03-21 14:29:38,827 - train - INFO - Building dataset...
2023-03-21 14:30:04,887 - train - INFO - Building model...
2023-03-21 14:30:04,892 - train - INFO - Total number of trainable parameters: 376964
2023-03-21 14:30:06,050 - train - INFO - Saver will maximize F1_macro...
2023-03-21 14:30:06,051 - train - INFO - Training...
2023-03-21 14:30:06,051 - train - INFO - Starting epoch 1...
2023-03-21 14:30:33,889 - train - INFO - Evaluating at epoch 1...
2023-03-21 14:30:41,546 - train - INFO - New best checkpoint at epoch 1...
2023-03-21 14:30:41,547 - train - INFO - Dev loss: 0.757, acc: 0.744, F1_weighted: 0.635, F1_macro: 0.213, F1_micro: 0.744, recall: 0.744, precision: 0.554, best_thresh: 0.500
2023-03-21 14:30:41,547 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:30:41,548 - train - INFO - Starting epoch 2...
2023-03-21 14:31:09,938 - train - INFO - Evaluating at epoch 2...
2023-03-21 14:31:16,972 - train - INFO - New best checkpoint at epoch 2...
2023-03-21 14:31:16,973 - train - INFO - Dev loss: 0.734, acc: 0.744, F1_weighted: 0.635, F1_macro: 0.213, F1_micro: 0.744, recall: 0.744, precision: 0.554, best_thresh: 0.500
2023-03-21 14:31:16,973 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:31:16,974 - train - INFO - Starting epoch 3...
2023-03-21 14:31:44,232 - train - INFO - Evaluating at epoch 3...
2023-03-21 14:31:51,941 - train - INFO - New best checkpoint at epoch 3...
2023-03-21 14:31:51,942 - train - INFO - Dev loss: 0.718, acc: 0.744, F1_weighted: 0.635, F1_macro: 0.213, F1_micro: 0.744, recall: 0.744, precision: 0.554, best_thresh: 0.500
2023-03-21 14:31:51,942 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:31:51,944 - train - INFO - Starting epoch 4...
2023-03-21 14:32:19,707 - train - INFO - Evaluating at epoch 4...
2023-03-21 14:32:27,186 - train - INFO - New best checkpoint at epoch 4...
2023-03-21 14:32:27,187 - train - INFO - Dev loss: 0.704, acc: 0.744, F1_weighted: 0.635, F1_macro: 0.213, F1_micro: 0.744, recall: 0.744, precision: 0.554, best_thresh: 0.500
2023-03-21 14:32:27,187 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:32:27,188 - train - INFO - Starting epoch 5...
2023-03-21 14:32:54,615 - train - INFO - Evaluating at epoch 5...
2023-03-21 14:33:02,165 - train - INFO - New best checkpoint at epoch 5...
2023-03-21 14:33:02,166 - train - INFO - Dev loss: 0.695, acc: 0.744, F1_weighted: 0.635, F1_macro: 0.213, F1_micro: 0.744, recall: 0.744, precision: 0.554, best_thresh: 0.500
2023-03-21 14:33:02,166 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:33:02,168 - train - INFO - Starting epoch 6...
2023-03-21 14:33:29,461 - train - INFO - Evaluating at epoch 6...
2023-03-21 14:33:36,844 - train - INFO - New best checkpoint at epoch 6...
2023-03-21 14:33:36,845 - train - INFO - Dev loss: 0.684, acc: 0.744, F1_weighted: 0.635, F1_macro: 0.213, F1_micro: 0.744, recall: 0.744, precision: 0.554, best_thresh: 0.500
2023-03-21 14:33:36,845 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:33:36,846 - train - INFO - Starting epoch 7...
2023-03-21 14:34:04,924 - train - INFO - Evaluating at epoch 7...
2023-03-21 14:34:12,299 - train - INFO - New best checkpoint at epoch 7...
2023-03-21 14:34:12,299 - train - INFO - Dev loss: 0.678, acc: 0.744, F1_weighted: 0.635, F1_macro: 0.213, F1_micro: 0.744, recall: 0.744, precision: 0.554, best_thresh: 0.500
2023-03-21 14:34:12,299 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:34:12,300 - train - INFO - Starting epoch 8...
2023-03-21 14:34:39,942 - train - INFO - Evaluating at epoch 8...
2023-03-21 14:34:47,513 - train - INFO - New best checkpoint at epoch 8...
2023-03-21 14:34:47,514 - train - INFO - Dev loss: 0.671, acc: 0.744, F1_weighted: 0.635, F1_macro: 0.213, F1_micro: 0.744, recall: 0.744, precision: 0.554, best_thresh: 0.500
2023-03-21 14:34:47,514 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:34:47,516 - train - INFO - Starting epoch 9...
2023-03-21 14:35:14,907 - train - INFO - Evaluating at epoch 9...
2023-03-21 14:35:22,473 - train - INFO - New best checkpoint at epoch 9...
2023-03-21 14:35:22,474 - train - INFO - Dev loss: 0.667, acc: 0.744, F1_weighted: 0.635, F1_macro: 0.213, F1_micro: 0.744, recall: 0.744, precision: 0.554, best_thresh: 0.500
2023-03-21 14:35:22,474 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:35:22,476 - train - INFO - Starting epoch 10...
2023-03-21 14:35:49,432 - train - INFO - Evaluating at epoch 10...
2023-03-21 14:35:57,041 - train - INFO - New best checkpoint at epoch 10...
2023-03-21 14:35:57,041 - train - INFO - Dev loss: 0.663, acc: 0.747, F1_weighted: 0.640, F1_macro: 0.259, F1_micro: 0.747, recall: 0.747, precision: 0.578, best_thresh: 0.500
2023-03-21 14:35:57,041 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:35:57,042 - train - INFO - Starting epoch 11...
2023-03-21 14:36:24,281 - train - INFO - Evaluating at epoch 11...
2023-03-21 14:36:31,642 - train - INFO - Dev loss: 0.661, acc: 0.744, F1_weighted: 0.635, F1_macro: 0.213, F1_micro: 0.744, recall: 0.744, precision: 0.554, best_thresh: 0.500
2023-03-21 14:36:31,642 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:36:31,643 - train - INFO - Starting epoch 12...
2023-03-21 14:36:58,073 - train - INFO - Evaluating at epoch 12...
2023-03-21 14:37:05,582 - train - INFO - Dev loss: 0.657, acc: 0.744, F1_weighted: 0.635, F1_macro: 0.213, F1_micro: 0.744, recall: 0.744, precision: 0.554, best_thresh: 0.500
2023-03-21 14:37:05,582 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:37:05,583 - train - INFO - Starting epoch 13...
2023-03-21 14:37:32,449 - train - INFO - Evaluating at epoch 13...
2023-03-21 14:37:39,965 - train - INFO - Dev loss: 0.651, acc: 0.742, F1_weighted: 0.634, F1_macro: 0.213, F1_micro: 0.742, recall: 0.742, precision: 0.554, best_thresh: 0.500
2023-03-21 14:37:39,965 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:37:39,966 - train - INFO - Starting epoch 14...
2023-03-21 14:38:07,050 - train - INFO - Evaluating at epoch 14...
2023-03-21 14:38:14,508 - train - INFO - New best checkpoint at epoch 14...
2023-03-21 14:38:14,509 - train - INFO - Dev loss: 0.648, acc: 0.749, F1_weighted: 0.649, F1_macro: 0.269, F1_micro: 0.749, recall: 0.749, precision: 0.720, best_thresh: 0.500
2023-03-21 14:38:14,509 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:38:14,510 - train - INFO - Starting epoch 15...
2023-03-21 14:38:40,958 - train - INFO - Evaluating at epoch 15...
2023-03-21 14:38:48,214 - train - INFO - Dev loss: 0.646, acc: 0.747, F1_weighted: 0.641, F1_macro: 0.219, F1_micro: 0.747, recall: 0.747, precision: 0.767, best_thresh: 0.500
2023-03-21 14:38:48,215 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:38:48,216 - train - INFO - Starting epoch 16...
2023-03-21 14:39:15,491 - train - INFO - Evaluating at epoch 16...
2023-03-21 14:39:22,834 - train - INFO - New best checkpoint at epoch 16...
2023-03-21 14:39:22,835 - train - INFO - Dev loss: 0.643, acc: 0.751, F1_weighted: 0.650, F1_macro: 0.303, F1_micro: 0.751, recall: 0.751, precision: 0.791, best_thresh: 0.500
2023-03-21 14:39:22,835 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:39:22,836 - train - INFO - Starting epoch 17...
2023-03-21 14:39:50,970 - train - INFO - Evaluating at epoch 17...
2023-03-21 14:39:58,186 - train - INFO - New best checkpoint at epoch 17...
2023-03-21 14:39:58,187 - train - INFO - Dev loss: 0.639, acc: 0.762, F1_weighted: 0.683, F1_macro: 0.476, F1_micro: 0.762, recall: 0.762, precision: 0.695, best_thresh: 0.500
2023-03-21 14:39:58,187 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:39:58,189 - train - INFO - Starting epoch 18...
2023-03-21 14:40:24,743 - train - INFO - Evaluating at epoch 18...
2023-03-21 14:40:32,091 - train - INFO - Dev loss: 0.636, acc: 0.751, F1_weighted: 0.657, F1_macro: 0.312, F1_micro: 0.751, recall: 0.751, precision: 0.708, best_thresh: 0.500
2023-03-21 14:40:32,091 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:40:32,092 - train - INFO - Starting epoch 19...
2023-03-21 14:40:59,087 - train - INFO - Evaluating at epoch 19...
2023-03-21 14:41:06,322 - train - INFO - Dev loss: 0.633, acc: 0.751, F1_weighted: 0.662, F1_macro: 0.317, F1_micro: 0.751, recall: 0.751, precision: 0.679, best_thresh: 0.500
2023-03-21 14:41:06,322 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:41:06,324 - train - INFO - Starting epoch 20...
2023-03-21 14:41:33,391 - train - INFO - Evaluating at epoch 20...
2023-03-21 14:41:40,784 - train - INFO - Dev loss: 0.632, acc: 0.756, F1_weighted: 0.668, F1_macro: 0.322, F1_micro: 0.756, recall: 0.756, precision: 0.704, best_thresh: 0.500
2023-03-21 14:41:40,785 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:41:40,786 - train - INFO - Starting epoch 21...
2023-03-21 14:42:09,330 - train - INFO - Evaluating at epoch 21...
2023-03-21 14:42:16,687 - train - INFO - Dev loss: 0.629, acc: 0.767, F1_weighted: 0.698, F1_macro: 0.408, F1_micro: 0.767, recall: 0.767, precision: 0.720, best_thresh: 0.500
2023-03-21 14:42:16,687 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:42:16,688 - train - INFO - Starting epoch 22...
2023-03-21 14:42:44,136 - train - INFO - Evaluating at epoch 22...
2023-03-21 14:42:51,581 - train - INFO - Dev loss: 0.628, acc: 0.758, F1_weighted: 0.673, F1_macro: 0.355, F1_micro: 0.758, recall: 0.758, precision: 0.695, best_thresh: 0.500
2023-03-21 14:42:51,582 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:42:51,583 - train - INFO - Starting epoch 23...
2023-03-21 14:43:18,876 - train - INFO - Evaluating at epoch 23...
2023-03-21 14:43:26,865 - train - INFO - Dev loss: 0.630, acc: 0.747, F1_weighted: 0.644, F1_macro: 0.264, F1_micro: 0.747, recall: 0.747, precision: 0.684, best_thresh: 0.500
2023-03-21 14:43:26,866 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:43:26,867 - train - INFO - Starting epoch 24...
2023-03-21 14:43:54,305 - train - INFO - Evaluating at epoch 24...
2023-03-21 14:44:02,299 - train - INFO - New best checkpoint at epoch 24...
2023-03-21 14:44:02,299 - train - INFO - Dev loss: 0.628, acc: 0.762, F1_weighted: 0.714, F1_macro: 0.560, F1_micro: 0.762, recall: 0.762, precision: 0.716, best_thresh: 0.500
2023-03-21 14:44:02,300 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:44:02,301 - train - INFO - Starting epoch 25...
2023-03-21 14:44:29,587 - train - INFO - Evaluating at epoch 25...
2023-03-21 14:44:37,008 - train - INFO - Dev loss: 0.630, acc: 0.747, F1_weighted: 0.667, F1_macro: 0.291, F1_micro: 0.747, recall: 0.747, precision: 0.679, best_thresh: 0.500
2023-03-21 14:44:37,008 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:44:37,009 - train - INFO - Starting epoch 26...
2023-03-21 14:45:04,533 - train - INFO - Evaluating at epoch 26...
2023-03-21 14:45:11,842 - train - INFO - Dev loss: 0.630, acc: 0.758, F1_weighted: 0.701, F1_macro: 0.404, F1_micro: 0.758, recall: 0.758, precision: 0.729, best_thresh: 0.500
2023-03-21 14:45:11,843 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:45:11,844 - train - INFO - Starting epoch 27...
2023-03-21 14:45:39,091 - train - INFO - Evaluating at epoch 27...
2023-03-21 14:45:46,423 - train - INFO - Dev loss: 0.632, acc: 0.749, F1_weighted: 0.657, F1_macro: 0.279, F1_micro: 0.749, recall: 0.749, precision: 0.688, best_thresh: 0.500
2023-03-21 14:45:46,424 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:45:46,425 - train - INFO - Starting epoch 28...
2023-03-21 14:46:14,469 - train - INFO - Evaluating at epoch 28...
2023-03-21 14:46:22,203 - train - INFO - Dev loss: 0.632, acc: 0.747, F1_weighted: 0.679, F1_macro: 0.380, F1_micro: 0.747, recall: 0.747, precision: 0.696, best_thresh: 0.500
2023-03-21 14:46:22,203 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:46:22,205 - train - INFO - Starting epoch 29...
2023-03-21 14:46:49,744 - train - INFO - Evaluating at epoch 29...
2023-03-21 14:46:57,187 - train - INFO - Dev loss: 0.634, acc: 0.751, F1_weighted: 0.672, F1_macro: 0.296, F1_micro: 0.751, recall: 0.751, precision: 0.693, best_thresh: 0.500
2023-03-21 14:46:57,188 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:46:57,189 - train - INFO - Starting epoch 30...
2023-03-21 14:47:24,677 - train - INFO - Evaluating at epoch 30...
2023-03-21 14:47:32,426 - train - INFO - Dev loss: 0.634, acc: 0.749, F1_weighted: 0.685, F1_macro: 0.388, F1_micro: 0.749, recall: 0.749, precision: 0.707, best_thresh: 0.500
2023-03-21 14:47:32,426 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:47:32,428 - train - INFO - Starting epoch 31...
2023-03-21 14:48:00,169 - train - INFO - Evaluating at epoch 31...
2023-03-21 14:48:07,790 - train - INFO - Dev loss: 0.637, acc: 0.751, F1_weighted: 0.663, F1_macro: 0.284, F1_micro: 0.751, recall: 0.751, precision: 0.691, best_thresh: 0.500
2023-03-21 14:48:07,790 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:48:07,813 - train - INFO - Training DONE. Evaluating model...
2023-03-21 14:48:14,763 - train - INFO - DEV set prediction results: loss: 0.503, acc: 0.762, F1_weighted: 0.714, F1_macro: 0.560, F1_micro: 0.762, recall: 0.762, precision: 0.716, best_thresh: 0.500
2023-03-21 14:48:24,570 - train - INFO - TEST set prediction results: loss: 0.878, acc: 0.651, F1_weighted: 0.614, F1_macro: 0.494, F1_micro: 0.651, recall: 0.651, precision: 0.608, best_thresh: 0.500
