2023-03-21 13:28:52,323 - train - INFO - Log directory: ./model_saved/train/train-04
2023-03-21 13:28:52,325 - train - INFO - Args: {
    "cl_decay_steps": 3000,
    "cuda": true,
    "data_augment": true,
    "dcgru_activation": "tanh",
    "do_train": true,
    "dropout": 0.5,
    "eval_every": 1,
    "filter_type": "dual_random_walk",
    "fine_tune": false,
    "graph_type": "individual",
    "input_dim": 200,
    "input_dir": "../tusz_resampled/",
    "l2_wd": 0.0005,
    "load_model_path": null,
    "lr_init": 0.0003,
    "max_diffusion_step": 2,
    "max_grad_norm": 5.0,
    "max_seq_len": 12,
    "maximize_metric": true,
    "metric_avg": "weighted",
    "metric_name": "F1_macro",
    "model_name": "dcrnn",
    "num_classes": 4,
    "num_epochs": 60,
    "num_nodes": 19,
    "num_rnn_layers": 2,
    "num_workers": 8,
    "output_dim": 100,
    "output_seq_len": 12,
    "patience": 5,
    "preproc_dir": null,
    "preprocess": "fft_delta",
    "pretrained_num_rnn_layers": 3,
    "rand_seed": 123,
    "raw_data_dir": "../tusz_raw/",
    "rnn_units": 64,
    "save_dir": "./model_saved/train/train-04",
    "task": "classification",
    "test_batch_size": 128,
    "time_step_size": 1,
    "top_k": 3,
    "train_batch_size": 40,
    "use_curriculum_learning": false
}
2023-03-21 13:28:52,326 - train - INFO - Building dataset...
2023-03-21 13:29:18,911 - train - INFO - Building model...
2023-03-21 13:29:18,914 - train - INFO - Total number of trainable parameters: 376964
2023-03-21 13:29:20,013 - train - INFO - Saver will maximize F1_macro...
2023-03-21 13:29:20,013 - train - INFO - Training...
2023-03-21 13:29:20,014 - train - INFO - Starting epoch 1...
2023-03-21 13:29:47,327 - train - INFO - Evaluating at epoch 1...
2023-03-21 13:29:55,127 - train - INFO - New best checkpoint at epoch 1...
2023-03-21 13:29:55,127 - train - INFO - Dev loss: 0.760, acc: 0.744, F1_weighted: 0.635, F1_macro: 0.213, F1_micro: 0.744, recall: 0.744, precision: 0.554, best_thresh: 0.500
2023-03-21 13:29:55,127 - train - INFO - Visualizing in TensorBoard...
2023-03-21 13:29:55,129 - train - INFO - Starting epoch 2...
2023-03-21 13:30:22,807 - train - INFO - Evaluating at epoch 2...
2023-03-21 13:30:30,890 - train - INFO - New best checkpoint at epoch 2...
2023-03-21 13:30:30,891 - train - INFO - Dev loss: 0.725, acc: 0.744, F1_weighted: 0.635, F1_macro: 0.213, F1_micro: 0.744, recall: 0.744, precision: 0.554, best_thresh: 0.500
2023-03-21 13:30:30,891 - train - INFO - Visualizing in TensorBoard...
2023-03-21 13:30:30,892 - train - INFO - Starting epoch 3...
2023-03-21 13:30:59,321 - train - INFO - Evaluating at epoch 3...
2023-03-21 13:31:06,709 - train - INFO - New best checkpoint at epoch 3...
2023-03-21 13:31:06,709 - train - INFO - Dev loss: 0.698, acc: 0.744, F1_weighted: 0.635, F1_macro: 0.213, F1_micro: 0.744, recall: 0.744, precision: 0.554, best_thresh: 0.500
2023-03-21 13:31:06,709 - train - INFO - Visualizing in TensorBoard...
2023-03-21 13:31:06,712 - train - INFO - Starting epoch 4...
2023-03-21 13:31:34,088 - train - INFO - Evaluating at epoch 4...
2023-03-21 13:31:41,659 - train - INFO - New best checkpoint at epoch 4...
2023-03-21 13:31:41,659 - train - INFO - Dev loss: 0.672, acc: 0.756, F1_weighted: 0.665, F1_macro: 0.244, F1_micro: 0.756, recall: 0.756, precision: 0.705, best_thresh: 0.500
2023-03-21 13:31:41,659 - train - INFO - Visualizing in TensorBoard...
2023-03-21 13:31:41,661 - train - INFO - Starting epoch 5...
2023-03-21 13:32:08,127 - train - INFO - Evaluating at epoch 5...
2023-03-21 13:32:15,478 - train - INFO - New best checkpoint at epoch 5...
2023-03-21 13:32:15,478 - train - INFO - Dev loss: 0.654, acc: 0.753, F1_weighted: 0.676, F1_macro: 0.255, F1_micro: 0.753, recall: 0.753, precision: 0.663, best_thresh: 0.500
2023-03-21 13:32:15,479 - train - INFO - Visualizing in TensorBoard...
2023-03-21 13:32:15,480 - train - INFO - Starting epoch 6...
2023-03-21 13:32:42,780 - train - INFO - Evaluating at epoch 6...
2023-03-21 13:32:50,270 - train - INFO - New best checkpoint at epoch 6...
2023-03-21 13:32:50,270 - train - INFO - Dev loss: 0.638, acc: 0.782, F1_weighted: 0.737, F1_macro: 0.385, F1_micro: 0.782, recall: 0.782, precision: 0.735, best_thresh: 0.500
2023-03-21 13:32:50,271 - train - INFO - Visualizing in TensorBoard...
2023-03-21 13:32:50,272 - train - INFO - Starting epoch 7...
2023-03-21 13:33:16,981 - train - INFO - Evaluating at epoch 7...
2023-03-21 13:33:24,534 - train - INFO - Dev loss: 0.631, acc: 0.767, F1_weighted: 0.697, F1_macro: 0.373, F1_micro: 0.767, recall: 0.767, precision: 0.716, best_thresh: 0.500
2023-03-21 13:33:24,534 - train - INFO - Visualizing in TensorBoard...
2023-03-21 13:33:24,536 - train - INFO - Starting epoch 8...
2023-03-21 13:33:51,328 - train - INFO - Evaluating at epoch 8...
2023-03-21 13:33:58,833 - train - INFO - New best checkpoint at epoch 8...
2023-03-21 13:33:58,834 - train - INFO - Dev loss: 0.621, acc: 0.773, F1_weighted: 0.719, F1_macro: 0.408, F1_micro: 0.773, recall: 0.773, precision: 0.715, best_thresh: 0.500
2023-03-21 13:33:58,834 - train - INFO - Visualizing in TensorBoard...
2023-03-21 13:33:58,835 - train - INFO - Starting epoch 9...
2023-03-21 13:34:25,704 - train - INFO - Evaluating at epoch 9...
2023-03-21 13:34:33,382 - train - INFO - New best checkpoint at epoch 9...
2023-03-21 13:34:33,382 - train - INFO - Dev loss: 0.614, acc: 0.773, F1_weighted: 0.726, F1_macro: 0.423, F1_micro: 0.773, recall: 0.773, precision: 0.723, best_thresh: 0.500
2023-03-21 13:34:33,382 - train - INFO - Visualizing in TensorBoard...
2023-03-21 13:34:33,383 - train - INFO - Starting epoch 10...
2023-03-21 13:35:00,482 - train - INFO - Evaluating at epoch 10...
2023-03-21 13:35:07,827 - train - INFO - New best checkpoint at epoch 10...
2023-03-21 13:35:07,827 - train - INFO - Dev loss: 0.610, acc: 0.778, F1_weighted: 0.755, F1_macro: 0.469, F1_micro: 0.778, recall: 0.778, precision: 0.741, best_thresh: 0.500
2023-03-21 13:35:07,828 - train - INFO - Visualizing in TensorBoard...
2023-03-21 13:35:07,830 - train - INFO - Starting epoch 11...
2023-03-21 13:35:34,329 - train - INFO - Evaluating at epoch 11...
2023-03-21 13:35:41,943 - train - INFO - Dev loss: 0.605, acc: 0.771, F1_weighted: 0.733, F1_macro: 0.446, F1_micro: 0.771, recall: 0.771, precision: 0.724, best_thresh: 0.500
2023-03-21 13:35:41,943 - train - INFO - Visualizing in TensorBoard...
2023-03-21 13:35:41,944 - train - INFO - Starting epoch 12...
2023-03-21 13:36:08,908 - train - INFO - Evaluating at epoch 12...
2023-03-21 13:36:16,330 - train - INFO - Dev loss: 0.602, acc: 0.776, F1_weighted: 0.715, F1_macro: 0.425, F1_micro: 0.776, recall: 0.776, precision: 0.740, best_thresh: 0.500
2023-03-21 13:36:16,330 - train - INFO - Visualizing in TensorBoard...
2023-03-21 13:36:16,332 - train - INFO - Starting epoch 13...
2023-03-21 13:36:42,841 - train - INFO - Evaluating at epoch 13...
2023-03-21 13:36:50,337 - train - INFO - Dev loss: 0.600, acc: 0.762, F1_weighted: 0.741, F1_macro: 0.456, F1_micro: 0.762, recall: 0.762, precision: 0.728, best_thresh: 0.500
2023-03-21 13:36:50,337 - train - INFO - Visualizing in TensorBoard...
2023-03-21 13:36:50,338 - train - INFO - Starting epoch 14...
2023-03-21 13:37:17,060 - train - INFO - Evaluating at epoch 14...
2023-03-21 13:37:24,426 - train - INFO - New best checkpoint at epoch 14...
2023-03-21 13:37:24,426 - train - INFO - Dev loss: 0.598, acc: 0.773, F1_weighted: 0.767, F1_macro: 0.493, F1_micro: 0.773, recall: 0.773, precision: 0.761, best_thresh: 0.500
2023-03-21 13:37:24,426 - train - INFO - Visualizing in TensorBoard...
2023-03-21 13:37:24,428 - train - INFO - Starting epoch 15...
2023-03-21 13:37:52,334 - train - INFO - Evaluating at epoch 15...
2023-03-21 13:38:00,094 - train - INFO - Dev loss: 0.596, acc: 0.760, F1_weighted: 0.738, F1_macro: 0.465, F1_micro: 0.760, recall: 0.760, precision: 0.724, best_thresh: 0.500
2023-03-21 13:38:00,094 - train - INFO - Visualizing in TensorBoard...
2023-03-21 13:38:00,095 - train - INFO - Starting epoch 16...
2023-03-21 13:38:26,786 - train - INFO - Evaluating at epoch 16...
2023-03-21 13:38:34,104 - train - INFO - Dev loss: 0.595, acc: 0.771, F1_weighted: 0.747, F1_macro: 0.464, F1_micro: 0.771, recall: 0.771, precision: 0.733, best_thresh: 0.500
2023-03-21 13:38:34,105 - train - INFO - Visualizing in TensorBoard...
2023-03-21 13:38:34,106 - train - INFO - Starting epoch 17...
2023-03-21 13:39:01,386 - train - INFO - Evaluating at epoch 17...
2023-03-21 13:39:08,887 - train - INFO - Dev loss: 0.601, acc: 0.709, F1_weighted: 0.723, F1_macro: 0.479, F1_micro: 0.709, recall: 0.709, precision: 0.761, best_thresh: 0.500
2023-03-21 13:39:08,887 - train - INFO - Visualizing in TensorBoard...
2023-03-21 13:39:08,888 - train - INFO - Starting epoch 18...
2023-03-21 13:39:35,428 - train - INFO - Evaluating at epoch 18...
2023-03-21 13:39:43,474 - train - INFO - Dev loss: 0.601, acc: 0.753, F1_weighted: 0.739, F1_macro: 0.465, F1_micro: 0.753, recall: 0.753, precision: 0.729, best_thresh: 0.500
2023-03-21 13:39:43,474 - train - INFO - Visualizing in TensorBoard...
2023-03-21 13:39:43,475 - train - INFO - Starting epoch 19...
2023-03-21 13:40:10,431 - train - INFO - Evaluating at epoch 19...
2023-03-21 13:40:18,143 - train - INFO - Dev loss: 0.600, acc: 0.760, F1_weighted: 0.737, F1_macro: 0.456, F1_micro: 0.760, recall: 0.760, precision: 0.723, best_thresh: 0.500
2023-03-21 13:40:18,143 - train - INFO - Visualizing in TensorBoard...
2023-03-21 13:40:18,144 - train - INFO - Starting epoch 20...
2023-03-21 13:40:44,309 - train - INFO - Evaluating at epoch 20...
2023-03-21 13:40:51,691 - train - INFO - Dev loss: 0.600, acc: 0.749, F1_weighted: 0.711, F1_macro: 0.410, F1_micro: 0.749, recall: 0.749, precision: 0.694, best_thresh: 0.500
2023-03-21 13:40:51,692 - train - INFO - Visualizing in TensorBoard...
2023-03-21 13:40:51,693 - train - INFO - Starting epoch 21...
2023-03-21 13:41:18,699 - train - INFO - Evaluating at epoch 21...
2023-03-21 13:41:26,132 - train - INFO - Dev loss: 0.601, acc: 0.731, F1_weighted: 0.724, F1_macro: 0.452, F1_micro: 0.731, recall: 0.731, precision: 0.719, best_thresh: 0.500
2023-03-21 13:41:26,132 - train - INFO - Visualizing in TensorBoard...
2023-03-21 13:41:26,133 - train - INFO - Starting epoch 22...
2023-03-21 13:41:53,893 - train - INFO - Evaluating at epoch 22...
2023-03-21 13:42:01,291 - train - INFO - Dev loss: 0.605, acc: 0.711, F1_weighted: 0.713, F1_macro: 0.449, F1_micro: 0.711, recall: 0.711, precision: 0.719, best_thresh: 0.500
2023-03-21 13:42:01,292 - train - INFO - Visualizing in TensorBoard...
2023-03-21 13:42:01,293 - train - INFO - Starting epoch 23...
2023-03-21 13:42:28,126 - train - INFO - Evaluating at epoch 23...
2023-03-21 13:42:35,415 - train - INFO - Dev loss: 0.604, acc: 0.738, F1_weighted: 0.719, F1_macro: 0.427, F1_micro: 0.738, recall: 0.738, precision: 0.708, best_thresh: 0.500
2023-03-21 13:42:35,415 - train - INFO - Visualizing in TensorBoard...
2023-03-21 13:42:35,416 - train - INFO - Starting epoch 24...
2023-03-21 13:43:01,899 - train - INFO - Evaluating at epoch 24...
2023-03-21 13:43:09,793 - train - INFO - Dev loss: 0.604, acc: 0.756, F1_weighted: 0.721, F1_macro: 0.439, F1_micro: 0.756, recall: 0.756, precision: 0.705, best_thresh: 0.500
2023-03-21 13:43:09,794 - train - INFO - Visualizing in TensorBoard...
2023-03-21 13:43:09,795 - train - INFO - Starting epoch 25...
2023-03-21 13:43:37,256 - train - INFO - Evaluating at epoch 25...
2023-03-21 13:43:45,185 - train - INFO - Dev loss: 0.605, acc: 0.753, F1_weighted: 0.704, F1_macro: 0.424, F1_micro: 0.753, recall: 0.753, precision: 0.688, best_thresh: 0.500
2023-03-21 13:43:45,186 - train - INFO - Visualizing in TensorBoard...
2023-03-21 13:43:45,187 - train - INFO - Starting epoch 26...
2023-03-21 13:44:12,175 - train - INFO - Evaluating at epoch 26...
2023-03-21 13:44:19,601 - train - INFO - Dev loss: 0.605, acc: 0.769, F1_weighted: 0.728, F1_macro: 0.446, F1_micro: 0.769, recall: 0.769, precision: 0.720, best_thresh: 0.500
2023-03-21 13:44:19,601 - train - INFO - Visualizing in TensorBoard...
2023-03-21 13:44:19,603 - train - INFO - Starting epoch 27...
2023-03-21 13:44:46,368 - train - INFO - Evaluating at epoch 27...
2023-03-21 13:44:53,565 - train - INFO - Dev loss: 0.607, acc: 0.760, F1_weighted: 0.705, F1_macro: 0.430, F1_micro: 0.760, recall: 0.760, precision: 0.698, best_thresh: 0.500
2023-03-21 13:44:53,565 - train - INFO - Visualizing in TensorBoard...
2023-03-21 13:44:53,567 - train - INFO - Starting epoch 28...
2023-03-21 13:45:21,363 - train - INFO - Evaluating at epoch 28...
2023-03-21 13:45:28,776 - train - INFO - Dev loss: 0.609, acc: 0.751, F1_weighted: 0.711, F1_macro: 0.411, F1_micro: 0.751, recall: 0.751, precision: 0.694, best_thresh: 0.500
2023-03-21 13:45:28,777 - train - INFO - Visualizing in TensorBoard...
2023-03-21 13:45:28,779 - train - INFO - Starting epoch 29...
2023-03-21 13:45:55,978 - train - INFO - Evaluating at epoch 29...
2023-03-21 13:46:03,346 - train - INFO - Dev loss: 0.611, acc: 0.740, F1_weighted: 0.701, F1_macro: 0.411, F1_micro: 0.740, recall: 0.740, precision: 0.680, best_thresh: 0.500
2023-03-21 13:46:03,347 - train - INFO - Visualizing in TensorBoard...
2023-03-21 13:46:03,348 - train - INFO - Starting epoch 30...
2023-03-21 13:46:30,374 - train - INFO - Evaluating at epoch 30...
2023-03-21 13:46:37,561 - train - INFO - Dev loss: 0.613, acc: 0.722, F1_weighted: 0.709, F1_macro: 0.458, F1_micro: 0.722, recall: 0.722, precision: 0.698, best_thresh: 0.500
2023-03-21 13:46:37,562 - train - INFO - Visualizing in TensorBoard...
2023-03-21 13:46:37,563 - train - INFO - Starting epoch 31...
2023-03-21 13:47:03,978 - train - INFO - Evaluating at epoch 31...
2023-03-21 13:47:11,322 - train - INFO - Dev loss: 0.615, acc: 0.742, F1_weighted: 0.715, F1_macro: 0.454, F1_micro: 0.742, recall: 0.742, precision: 0.697, best_thresh: 0.500
2023-03-21 13:47:11,323 - train - INFO - Visualizing in TensorBoard...
2023-03-21 13:47:11,350 - train - INFO - Training DONE. Evaluating model...
2023-03-21 13:47:18,126 - train - INFO - DEV set prediction results: loss: 0.489, acc: 0.773, F1_weighted: 0.767, F1_macro: 0.493, F1_micro: 0.773, recall: 0.773, precision: 0.761, best_thresh: 0.500
2023-03-21 13:47:27,008 - train - INFO - TEST set prediction results: loss: 0.648, acc: 0.631, F1_weighted: 0.578, F1_macro: 0.437, F1_micro: 0.631, recall: 0.631, precision: 0.668, best_thresh: 0.500
