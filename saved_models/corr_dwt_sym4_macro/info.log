2023-03-22 11:04:47,143 - train - INFO - Log directory: ./model_saved/train/train-17
2023-03-22 11:04:47,146 - train - INFO - Args: {
    "cl_decay_steps": 3000,
    "cuda": true,
    "data_augment": true,
    "dcgru_activation": "tanh",
    "do_train": true,
    "dropout": 0.5,
    "eval_every": 1,
    "filter_type": "dual_random_walk",
    "fine_tune": false,
    "graph_type": "individual",
    "input_dim": 227,
    "input_dir": "../tusz_resampled/",
    "l2_wd": 0.0005,
    "load_model_path": null,
    "lr_init": 0.0003,
    "max_diffusion_step": 2,
    "max_grad_norm": 5.0,
    "max_seq_len": 12,
    "maximize_metric": true,
    "metric_avg": "weighted",
    "metric_name": "F1_macro",
    "model_name": "dcrnn",
    "num_classes": 4,
    "num_epochs": 60,
    "num_nodes": 19,
    "num_rnn_layers": 2,
    "num_workers": 8,
    "output_dim": 100,
    "output_seq_len": 12,
    "patience": 5,
    "preproc_dir": null,
    "preprocess": "dwt",
    "pretrained_num_rnn_layers": 3,
    "rand_seed": 123,
    "raw_data_dir": "../tusz_raw/",
    "rnn_units": 64,
    "save_dir": "./model_saved/train/train-17",
    "task": "classification",
    "test_batch_size": 128,
    "time_step_size": 1,
    "top_k": 3,
    "train_batch_size": 40,
    "use_curriculum_learning": false
}
2023-03-22 11:04:47,146 - train - INFO - Building dataset...
2023-03-22 11:05:14,316 - train - INFO - Building model...
2023-03-22 11:05:14,319 - train - INFO - Total number of trainable parameters: 402884
2023-03-22 11:05:15,481 - train - INFO - Saver will maximize F1_macro...
2023-03-22 11:05:15,482 - train - INFO - Training...
2023-03-22 11:05:15,483 - train - INFO - Starting epoch 1...
2023-03-22 11:05:45,057 - train - INFO - Evaluating at epoch 1...
2023-03-22 11:05:53,520 - train - INFO - New best checkpoint at epoch 1...
2023-03-22 11:05:53,520 - train - INFO - Dev loss: 0.704, acc: 0.744, F1_weighted: 0.635, F1_macro: 0.213, F1_micro: 0.744, recall: 0.744, precision: 0.554, best_thresh: 0.500
2023-03-22 11:05:53,520 - train - INFO - Visualizing in TensorBoard...
2023-03-22 11:05:53,521 - train - INFO - Starting epoch 2...
2023-03-22 11:06:21,577 - train - INFO - Evaluating at epoch 2...
2023-03-22 11:06:29,904 - train - INFO - New best checkpoint at epoch 2...
2023-03-22 11:06:29,905 - train - INFO - Dev loss: 0.688, acc: 0.744, F1_weighted: 0.635, F1_macro: 0.213, F1_micro: 0.744, recall: 0.744, precision: 0.554, best_thresh: 0.500
2023-03-22 11:06:29,905 - train - INFO - Visualizing in TensorBoard...
2023-03-22 11:06:29,906 - train - INFO - Starting epoch 3...
2023-03-22 11:06:58,824 - train - INFO - Evaluating at epoch 3...
2023-03-22 11:07:07,694 - train - INFO - New best checkpoint at epoch 3...
2023-03-22 11:07:07,695 - train - INFO - Dev loss: 0.676, acc: 0.744, F1_weighted: 0.635, F1_macro: 0.213, F1_micro: 0.744, recall: 0.744, precision: 0.554, best_thresh: 0.500
2023-03-22 11:07:07,695 - train - INFO - Visualizing in TensorBoard...
2023-03-22 11:07:07,696 - train - INFO - Starting epoch 4...
2023-03-22 11:07:36,735 - train - INFO - Evaluating at epoch 4...
2023-03-22 11:07:45,688 - train - INFO - New best checkpoint at epoch 4...
2023-03-22 11:07:45,689 - train - INFO - Dev loss: 0.669, acc: 0.744, F1_weighted: 0.635, F1_macro: 0.213, F1_micro: 0.744, recall: 0.744, precision: 0.554, best_thresh: 0.500
2023-03-22 11:07:45,689 - train - INFO - Visualizing in TensorBoard...
2023-03-22 11:07:45,690 - train - INFO - Starting epoch 5...
2023-03-22 11:08:14,819 - train - INFO - Evaluating at epoch 5...
2023-03-22 11:08:23,471 - train - INFO - New best checkpoint at epoch 5...
2023-03-22 11:08:23,472 - train - INFO - Dev loss: 0.658, acc: 0.742, F1_weighted: 0.636, F1_macro: 0.214, F1_micro: 0.742, recall: 0.742, precision: 0.556, best_thresh: 0.500
2023-03-22 11:08:23,472 - train - INFO - Visualizing in TensorBoard...
2023-03-22 11:08:23,473 - train - INFO - Starting epoch 6...
2023-03-22 11:08:52,216 - train - INFO - Evaluating at epoch 6...
2023-03-22 11:09:00,735 - train - INFO - New best checkpoint at epoch 6...
2023-03-22 11:09:00,736 - train - INFO - Dev loss: 0.647, acc: 0.758, F1_weighted: 0.672, F1_macro: 0.249, F1_micro: 0.758, recall: 0.758, precision: 0.676, best_thresh: 0.500
2023-03-22 11:09:00,736 - train - INFO - Visualizing in TensorBoard...
2023-03-22 11:09:00,738 - train - INFO - Starting epoch 7...
2023-03-22 11:09:30,426 - train - INFO - Evaluating at epoch 7...
2023-03-22 11:09:39,656 - train - INFO - New best checkpoint at epoch 7...
2023-03-22 11:09:39,657 - train - INFO - Dev loss: 0.640, acc: 0.758, F1_weighted: 0.678, F1_macro: 0.298, F1_micro: 0.758, recall: 0.758, precision: 0.704, best_thresh: 0.500
2023-03-22 11:09:39,657 - train - INFO - Visualizing in TensorBoard...
2023-03-22 11:09:39,659 - train - INFO - Starting epoch 8...
2023-03-22 11:10:08,191 - train - INFO - Evaluating at epoch 8...
2023-03-22 11:10:17,216 - train - INFO - New best checkpoint at epoch 8...
2023-03-22 11:10:17,217 - train - INFO - Dev loss: 0.635, acc: 0.764, F1_weighted: 0.688, F1_macro: 0.307, F1_micro: 0.764, recall: 0.764, precision: 0.727, best_thresh: 0.500
2023-03-22 11:10:17,217 - train - INFO - Visualizing in TensorBoard...
2023-03-22 11:10:17,218 - train - INFO - Starting epoch 9...
2023-03-22 11:10:46,713 - train - INFO - Evaluating at epoch 9...
2023-03-22 11:10:55,090 - train - INFO - New best checkpoint at epoch 9...
2023-03-22 11:10:55,090 - train - INFO - Dev loss: 0.628, acc: 0.776, F1_weighted: 0.711, F1_macro: 0.451, F1_micro: 0.776, recall: 0.776, precision: 0.743, best_thresh: 0.500
2023-03-22 11:10:55,091 - train - INFO - Visualizing in TensorBoard...
2023-03-22 11:10:55,092 - train - INFO - Starting epoch 10...
2023-03-22 11:11:24,380 - train - INFO - Evaluating at epoch 10...
2023-03-22 11:11:33,431 - train - INFO - New best checkpoint at epoch 10...
2023-03-22 11:11:33,431 - train - INFO - Dev loss: 0.621, acc: 0.784, F1_weighted: 0.742, F1_macro: 0.474, F1_micro: 0.784, recall: 0.784, precision: 0.743, best_thresh: 0.500
2023-03-22 11:11:33,432 - train - INFO - Visualizing in TensorBoard...
2023-03-22 11:11:33,433 - train - INFO - Starting epoch 11...
2023-03-22 11:12:01,733 - train - INFO - Evaluating at epoch 11...
2023-03-22 11:12:09,957 - train - INFO - Dev loss: 0.617, acc: 0.776, F1_weighted: 0.726, F1_macro: 0.381, F1_micro: 0.776, recall: 0.776, precision: 0.731, best_thresh: 0.500
2023-03-22 11:12:09,957 - train - INFO - Visualizing in TensorBoard...
2023-03-22 11:12:09,959 - train - INFO - Starting epoch 12...
2023-03-22 11:12:38,154 - train - INFO - Evaluating at epoch 12...
2023-03-22 11:12:46,696 - train - INFO - New best checkpoint at epoch 12...
2023-03-22 11:12:46,696 - train - INFO - Dev loss: 0.614, acc: 0.782, F1_weighted: 0.728, F1_macro: 0.483, F1_micro: 0.782, recall: 0.782, precision: 0.737, best_thresh: 0.500
2023-03-22 11:12:46,697 - train - INFO - Visualizing in TensorBoard...
2023-03-22 11:12:46,698 - train - INFO - Starting epoch 13...
2023-03-22 11:13:15,142 - train - INFO - Evaluating at epoch 13...
2023-03-22 11:13:24,344 - train - INFO - New best checkpoint at epoch 13...
2023-03-22 11:13:24,345 - train - INFO - Dev loss: 0.610, acc: 0.784, F1_weighted: 0.736, F1_macro: 0.491, F1_micro: 0.784, recall: 0.784, precision: 0.738, best_thresh: 0.500
2023-03-22 11:13:24,345 - train - INFO - Visualizing in TensorBoard...
2023-03-22 11:13:24,346 - train - INFO - Starting epoch 14...
2023-03-22 11:13:52,471 - train - INFO - Evaluating at epoch 14...
2023-03-22 11:14:00,884 - train - INFO - Dev loss: 0.609, acc: 0.782, F1_weighted: 0.729, F1_macro: 0.478, F1_micro: 0.782, recall: 0.782, precision: 0.739, best_thresh: 0.500
2023-03-22 11:14:00,884 - train - INFO - Visualizing in TensorBoard...
2023-03-22 11:14:00,885 - train - INFO - Starting epoch 15...
2023-03-22 11:14:29,443 - train - INFO - Evaluating at epoch 15...
2023-03-22 11:14:37,788 - train - INFO - New best checkpoint at epoch 15...
2023-03-22 11:14:37,789 - train - INFO - Dev loss: 0.608, acc: 0.789, F1_weighted: 0.743, F1_macro: 0.492, F1_micro: 0.789, recall: 0.789, precision: 0.748, best_thresh: 0.500
2023-03-22 11:14:37,789 - train - INFO - Visualizing in TensorBoard...
2023-03-22 11:14:37,790 - train - INFO - Starting epoch 16...
2023-03-22 11:15:06,461 - train - INFO - Evaluating at epoch 16...
2023-03-22 11:15:14,904 - train - INFO - Dev loss: 0.606, acc: 0.784, F1_weighted: 0.735, F1_macro: 0.477, F1_micro: 0.784, recall: 0.784, precision: 0.742, best_thresh: 0.500
2023-03-22 11:15:14,905 - train - INFO - Visualizing in TensorBoard...
2023-03-22 11:15:14,905 - train - INFO - Starting epoch 17...
2023-03-22 11:15:43,897 - train - INFO - Evaluating at epoch 17...
2023-03-22 11:15:53,159 - train - INFO - New best checkpoint at epoch 17...
2023-03-22 11:15:53,159 - train - INFO - Dev loss: 0.604, acc: 0.804, F1_weighted: 0.774, F1_macro: 0.544, F1_micro: 0.804, recall: 0.804, precision: 0.767, best_thresh: 0.500
2023-03-22 11:15:53,159 - train - INFO - Visualizing in TensorBoard...
2023-03-22 11:15:53,160 - train - INFO - Starting epoch 18...
2023-03-22 11:16:21,273 - train - INFO - Evaluating at epoch 18...
2023-03-22 11:16:29,677 - train - INFO - Dev loss: 0.602, acc: 0.787, F1_weighted: 0.740, F1_macro: 0.506, F1_micro: 0.787, recall: 0.787, precision: 0.744, best_thresh: 0.500
2023-03-22 11:16:29,677 - train - INFO - Visualizing in TensorBoard...
2023-03-22 11:16:29,678 - train - INFO - Starting epoch 19...
2023-03-22 11:16:58,318 - train - INFO - Evaluating at epoch 19...
2023-03-22 11:17:06,843 - train - INFO - Dev loss: 0.605, acc: 0.760, F1_weighted: 0.736, F1_macro: 0.504, F1_micro: 0.760, recall: 0.760, precision: 0.721, best_thresh: 0.500
2023-03-22 11:17:06,844 - train - INFO - Visualizing in TensorBoard...
2023-03-22 11:17:06,845 - train - INFO - Starting epoch 20...
2023-03-22 11:17:35,455 - train - INFO - Evaluating at epoch 20...
2023-03-22 11:17:44,635 - train - INFO - Dev loss: 0.604, acc: 0.778, F1_weighted: 0.748, F1_macro: 0.520, F1_micro: 0.778, recall: 0.778, precision: 0.737, best_thresh: 0.500
2023-03-22 11:17:44,635 - train - INFO - Visualizing in TensorBoard...
2023-03-22 11:17:44,637 - train - INFO - Starting epoch 21...
2023-03-22 11:18:13,169 - train - INFO - Evaluating at epoch 21...
2023-03-22 11:18:22,438 - train - INFO - Dev loss: 0.607, acc: 0.760, F1_weighted: 0.727, F1_macro: 0.504, F1_micro: 0.760, recall: 0.760, precision: 0.713, best_thresh: 0.500
2023-03-22 11:18:22,439 - train - INFO - Visualizing in TensorBoard...
2023-03-22 11:18:22,440 - train - INFO - Starting epoch 22...
2023-03-22 11:18:52,509 - train - INFO - Evaluating at epoch 22...
2023-03-22 11:19:01,015 - train - INFO - Dev loss: 0.608, acc: 0.758, F1_weighted: 0.742, F1_macro: 0.526, F1_micro: 0.758, recall: 0.758, precision: 0.730, best_thresh: 0.500
2023-03-22 11:19:01,015 - train - INFO - Visualizing in TensorBoard...
2023-03-22 11:19:01,016 - train - INFO - Starting epoch 23...
2023-03-22 11:19:29,035 - train - INFO - Evaluating at epoch 23...
2023-03-22 11:19:37,601 - train - INFO - Dev loss: 0.611, acc: 0.764, F1_weighted: 0.727, F1_macro: 0.501, F1_micro: 0.764, recall: 0.764, precision: 0.715, best_thresh: 0.500
2023-03-22 11:19:37,601 - train - INFO - Visualizing in TensorBoard...
2023-03-22 11:19:37,604 - train - INFO - Starting epoch 24...
2023-03-22 11:20:05,749 - train - INFO - Evaluating at epoch 24...
2023-03-22 11:20:14,241 - train - INFO - Dev loss: 0.616, acc: 0.713, F1_weighted: 0.697, F1_macro: 0.485, F1_micro: 0.713, recall: 0.713, precision: 0.683, best_thresh: 0.500
2023-03-22 11:20:14,241 - train - INFO - Visualizing in TensorBoard...
2023-03-22 11:20:14,242 - train - INFO - Starting epoch 25...
2023-03-22 11:20:43,571 - train - INFO - Evaluating at epoch 25...
2023-03-22 11:20:52,026 - train - INFO - Dev loss: 0.620, acc: 0.778, F1_weighted: 0.730, F1_macro: 0.472, F1_micro: 0.778, recall: 0.778, precision: 0.733, best_thresh: 0.500
2023-03-22 11:20:52,027 - train - INFO - Visualizing in TensorBoard...
2023-03-22 11:20:52,051 - train - INFO - Training DONE. Evaluating model...
2023-03-22 11:20:59,782 - train - INFO - DEV set prediction results: loss: 0.540, acc: 0.804, F1_weighted: 0.774, F1_macro: 0.544, F1_micro: 0.804, recall: 0.804, precision: 0.767, best_thresh: 0.500
2023-03-22 11:21:09,909 - train - INFO - TEST set prediction results: loss: 0.664, acc: 0.628, F1_weighted: 0.548, F1_macro: 0.428, F1_micro: 0.628, recall: 0.628, precision: 0.588, best_thresh: 0.500
