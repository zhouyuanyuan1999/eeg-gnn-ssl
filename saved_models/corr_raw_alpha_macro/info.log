2023-03-21 13:14:24,412 - train - INFO - Log directory: ./model_saved/train/train-03
2023-03-21 13:14:24,415 - train - INFO - Args: {
    "cl_decay_steps": 3000,
    "cuda": true,
    "data_augment": true,
    "dcgru_activation": "tanh",
    "do_train": true,
    "dropout": 0.5,
    "eval_every": 1,
    "filter_type": "dual_random_walk",
    "fine_tune": false,
    "graph_type": "individual",
    "input_dim": 200,
    "input_dir": "../tusz_resampled/",
    "l2_wd": 0.0005,
    "load_model_path": null,
    "lr_init": 0.0003,
    "max_diffusion_step": 2,
    "max_grad_norm": 5.0,
    "max_seq_len": 12,
    "maximize_metric": true,
    "metric_avg": "weighted",
    "metric_name": "F1_macro",
    "model_name": "dcrnn",
    "num_classes": 4,
    "num_epochs": 60,
    "num_nodes": 19,
    "num_rnn_layers": 2,
    "num_workers": 8,
    "output_dim": 100,
    "output_seq_len": 12,
    "patience": 5,
    "preproc_dir": null,
    "preprocess": "fft_alpha",
    "pretrained_num_rnn_layers": 3,
    "rand_seed": 123,
    "raw_data_dir": "../tusz_raw/",
    "rnn_units": 64,
    "save_dir": "./model_saved/train/train-03",
    "task": "classification",
    "test_batch_size": 128,
    "time_step_size": 1,
    "top_k": 3,
    "train_batch_size": 40,
    "use_curriculum_learning": false
}
2023-03-21 13:14:24,415 - train - INFO - Building dataset...
2023-03-21 13:14:51,500 - train - INFO - Building model...
2023-03-21 13:14:51,503 - train - INFO - Total number of trainable parameters: 376964
2023-03-21 13:14:52,542 - train - INFO - Saver will maximize F1_macro...
2023-03-21 13:14:52,542 - train - INFO - Training...
2023-03-21 13:14:52,543 - train - INFO - Starting epoch 1...
2023-03-21 13:15:19,229 - train - INFO - Evaluating at epoch 1...
2023-03-21 13:15:27,020 - train - INFO - New best checkpoint at epoch 1...
2023-03-21 13:15:27,020 - train - INFO - Dev loss: 0.752, acc: 0.744, F1_weighted: 0.635, F1_macro: 0.213, F1_micro: 0.744, recall: 0.744, precision: 0.554, best_thresh: 0.500
2023-03-21 13:15:27,020 - train - INFO - Visualizing in TensorBoard...
2023-03-21 13:15:27,022 - train - INFO - Starting epoch 2...
2023-03-21 13:15:54,927 - train - INFO - Evaluating at epoch 2...
2023-03-21 13:16:03,001 - train - INFO - New best checkpoint at epoch 2...
2023-03-21 13:16:03,001 - train - INFO - Dev loss: 0.711, acc: 0.744, F1_weighted: 0.635, F1_macro: 0.213, F1_micro: 0.744, recall: 0.744, precision: 0.554, best_thresh: 0.500
2023-03-21 13:16:03,001 - train - INFO - Visualizing in TensorBoard...
2023-03-21 13:16:03,003 - train - INFO - Starting epoch 3...
2023-03-21 13:16:31,419 - train - INFO - Evaluating at epoch 3...
2023-03-21 13:16:38,750 - train - INFO - New best checkpoint at epoch 3...
2023-03-21 13:16:38,751 - train - INFO - Dev loss: 0.689, acc: 0.744, F1_weighted: 0.635, F1_macro: 0.213, F1_micro: 0.744, recall: 0.744, precision: 0.554, best_thresh: 0.500
2023-03-21 13:16:38,751 - train - INFO - Visualizing in TensorBoard...
2023-03-21 13:16:38,753 - train - INFO - Starting epoch 4...
2023-03-21 13:17:06,631 - train - INFO - Evaluating at epoch 4...
2023-03-21 13:17:14,347 - train - INFO - New best checkpoint at epoch 4...
2023-03-21 13:17:14,348 - train - INFO - Dev loss: 0.664, acc: 0.742, F1_weighted: 0.636, F1_macro: 0.214, F1_micro: 0.742, recall: 0.742, precision: 0.556, best_thresh: 0.500
2023-03-21 13:17:14,348 - train - INFO - Visualizing in TensorBoard...
2023-03-21 13:17:14,349 - train - INFO - Starting epoch 5...
2023-03-21 13:17:42,173 - train - INFO - Evaluating at epoch 5...
2023-03-21 13:17:49,597 - train - INFO - New best checkpoint at epoch 5...
2023-03-21 13:17:49,597 - train - INFO - Dev loss: 0.651, acc: 0.742, F1_weighted: 0.639, F1_macro: 0.259, F1_micro: 0.742, recall: 0.742, precision: 0.578, best_thresh: 0.500
2023-03-21 13:17:49,598 - train - INFO - Visualizing in TensorBoard...
2023-03-21 13:17:49,598 - train - INFO - Starting epoch 6...
2023-03-21 13:18:16,121 - train - INFO - Evaluating at epoch 6...
2023-03-21 13:18:23,466 - train - INFO - Dev loss: 0.639, acc: 0.744, F1_weighted: 0.636, F1_macro: 0.214, F1_micro: 0.744, recall: 0.744, precision: 0.555, best_thresh: 0.500
2023-03-21 13:18:23,466 - train - INFO - Visualizing in TensorBoard...
2023-03-21 13:18:23,468 - train - INFO - Starting epoch 7...
2023-03-21 13:18:50,336 - train - INFO - Evaluating at epoch 7...
2023-03-21 13:18:57,650 - train - INFO - Dev loss: 0.631, acc: 0.747, F1_weighted: 0.649, F1_macro: 0.229, F1_micro: 0.747, recall: 0.747, precision: 0.685, best_thresh: 0.500
2023-03-21 13:18:57,650 - train - INFO - Visualizing in TensorBoard...
2023-03-21 13:18:57,651 - train - INFO - Starting epoch 8...
2023-03-21 13:19:24,813 - train - INFO - Evaluating at epoch 8...
2023-03-21 13:19:32,320 - train - INFO - New best checkpoint at epoch 8...
2023-03-21 13:19:32,320 - train - INFO - Dev loss: 0.624, acc: 0.747, F1_weighted: 0.647, F1_macro: 0.302, F1_micro: 0.747, recall: 0.747, precision: 0.650, best_thresh: 0.500
2023-03-21 13:19:32,321 - train - INFO - Visualizing in TensorBoard...
2023-03-21 13:19:32,322 - train - INFO - Starting epoch 9...
2023-03-21 13:19:59,683 - train - INFO - Evaluating at epoch 9...
2023-03-21 13:20:07,311 - train - INFO - New best checkpoint at epoch 9...
2023-03-21 13:20:07,312 - train - INFO - Dev loss: 0.621, acc: 0.747, F1_weighted: 0.653, F1_macro: 0.307, F1_micro: 0.747, recall: 0.747, precision: 0.653, best_thresh: 0.500
2023-03-21 13:20:07,312 - train - INFO - Visualizing in TensorBoard...
2023-03-21 13:20:07,313 - train - INFO - Starting epoch 10...
2023-03-21 13:20:34,294 - train - INFO - Evaluating at epoch 10...
2023-03-21 13:20:41,689 - train - INFO - New best checkpoint at epoch 10...
2023-03-21 13:20:41,690 - train - INFO - Dev loss: 0.617, acc: 0.764, F1_weighted: 0.688, F1_macro: 0.387, F1_micro: 0.764, recall: 0.764, precision: 0.720, best_thresh: 0.500
2023-03-21 13:20:41,690 - train - INFO - Visualizing in TensorBoard...
2023-03-21 13:20:41,691 - train - INFO - Starting epoch 11...
2023-03-21 13:21:08,694 - train - INFO - Evaluating at epoch 11...
2023-03-21 13:21:16,105 - train - INFO - New best checkpoint at epoch 11...
2023-03-21 13:21:16,105 - train - INFO - Dev loss: 0.611, acc: 0.778, F1_weighted: 0.716, F1_macro: 0.416, F1_micro: 0.778, recall: 0.778, precision: 0.750, best_thresh: 0.500
2023-03-21 13:21:16,106 - train - INFO - Visualizing in TensorBoard...
2023-03-21 13:21:16,107 - train - INFO - Starting epoch 12...
2023-03-21 13:21:43,611 - train - INFO - Evaluating at epoch 12...
2023-03-21 13:21:51,014 - train - INFO - Dev loss: 0.610, acc: 0.769, F1_weighted: 0.692, F1_macro: 0.402, F1_micro: 0.769, recall: 0.769, precision: 0.765, best_thresh: 0.500
2023-03-21 13:21:51,014 - train - INFO - Visualizing in TensorBoard...
2023-03-21 13:21:51,016 - train - INFO - Starting epoch 13...
2023-03-21 13:22:18,217 - train - INFO - Evaluating at epoch 13...
2023-03-21 13:22:25,513 - train - INFO - Dev loss: 0.609, acc: 0.764, F1_weighted: 0.679, F1_macro: 0.407, F1_micro: 0.764, recall: 0.764, precision: 0.741, best_thresh: 0.500
2023-03-21 13:22:25,514 - train - INFO - Visualizing in TensorBoard...
2023-03-21 13:22:25,516 - train - INFO - Starting epoch 14...
2023-03-21 13:22:52,817 - train - INFO - Evaluating at epoch 14...
2023-03-21 13:23:00,251 - train - INFO - Dev loss: 0.610, acc: 0.764, F1_weighted: 0.681, F1_macro: 0.388, F1_micro: 0.764, recall: 0.764, precision: 0.748, best_thresh: 0.500
2023-03-21 13:23:00,251 - train - INFO - Visualizing in TensorBoard...
2023-03-21 13:23:00,252 - train - INFO - Starting epoch 15...
2023-03-21 13:23:27,305 - train - INFO - Evaluating at epoch 15...
2023-03-21 13:23:34,778 - train - INFO - Dev loss: 0.612, acc: 0.767, F1_weighted: 0.686, F1_macro: 0.393, F1_micro: 0.767, recall: 0.767, precision: 0.776, best_thresh: 0.500
2023-03-21 13:23:34,778 - train - INFO - Visualizing in TensorBoard...
2023-03-21 13:23:34,780 - train - INFO - Starting epoch 16...
2023-03-21 13:24:01,698 - train - INFO - Evaluating at epoch 16...
2023-03-21 13:24:09,181 - train - INFO - Dev loss: 0.613, acc: 0.769, F1_weighted: 0.697, F1_macro: 0.382, F1_micro: 0.769, recall: 0.769, precision: 0.760, best_thresh: 0.500
2023-03-21 13:24:09,181 - train - INFO - Visualizing in TensorBoard...
2023-03-21 13:24:09,182 - train - INFO - Starting epoch 17...
2023-03-21 13:24:37,047 - train - INFO - Evaluating at epoch 17...
2023-03-21 13:24:44,516 - train - INFO - Dev loss: 0.613, acc: 0.778, F1_weighted: 0.718, F1_macro: 0.402, F1_micro: 0.778, recall: 0.778, precision: 0.752, best_thresh: 0.500
2023-03-21 13:24:44,516 - train - INFO - Visualizing in TensorBoard...
2023-03-21 13:24:44,517 - train - INFO - Starting epoch 18...
2023-03-21 13:25:11,371 - train - INFO - Evaluating at epoch 18...
2023-03-21 13:25:19,337 - train - INFO - Dev loss: 0.612, acc: 0.771, F1_weighted: 0.711, F1_macro: 0.395, F1_micro: 0.771, recall: 0.771, precision: 0.731, best_thresh: 0.500
2023-03-21 13:25:19,337 - train - INFO - Visualizing in TensorBoard...
2023-03-21 13:25:19,338 - train - INFO - Starting epoch 19...
2023-03-21 13:25:47,057 - train - INFO - Evaluating at epoch 19...
2023-03-21 13:25:54,411 - train - INFO - Dev loss: 0.613, acc: 0.767, F1_weighted: 0.700, F1_macro: 0.385, F1_micro: 0.767, recall: 0.767, precision: 0.732, best_thresh: 0.500
2023-03-21 13:25:54,412 - train - INFO - Visualizing in TensorBoard...
2023-03-21 13:25:54,413 - train - INFO - Starting epoch 20...
2023-03-21 13:26:21,860 - train - INFO - Evaluating at epoch 20...
2023-03-21 13:26:29,095 - train - INFO - Dev loss: 0.616, acc: 0.764, F1_weighted: 0.704, F1_macro: 0.390, F1_micro: 0.764, recall: 0.764, precision: 0.720, best_thresh: 0.500
2023-03-21 13:26:29,095 - train - INFO - Visualizing in TensorBoard...
2023-03-21 13:26:29,096 - train - INFO - Starting epoch 21...
2023-03-21 13:26:56,209 - train - INFO - Evaluating at epoch 21...
2023-03-21 13:27:03,512 - train - INFO - Dev loss: 0.622, acc: 0.656, F1_weighted: 0.649, F1_macro: 0.403, F1_micro: 0.656, recall: 0.656, precision: 0.648, best_thresh: 0.500
2023-03-21 13:27:03,512 - train - INFO - Visualizing in TensorBoard...
2023-03-21 13:27:03,514 - train - INFO - Starting epoch 22...
2023-03-21 13:27:30,815 - train - INFO - Evaluating at epoch 22...
2023-03-21 13:27:38,229 - train - INFO - New best checkpoint at epoch 22...
2023-03-21 13:27:38,230 - train - INFO - Dev loss: 0.626, acc: 0.720, F1_weighted: 0.695, F1_macro: 0.426, F1_micro: 0.720, recall: 0.720, precision: 0.685, best_thresh: 0.500
2023-03-21 13:27:38,230 - train - INFO - Visualizing in TensorBoard...
2023-03-21 13:27:38,231 - train - INFO - Starting epoch 23...
2023-03-21 13:28:05,436 - train - INFO - Evaluating at epoch 23...
2023-03-21 13:28:12,884 - train - INFO - Dev loss: 0.629, acc: 0.760, F1_weighted: 0.695, F1_macro: 0.396, F1_micro: 0.760, recall: 0.760, precision: 0.700, best_thresh: 0.500
2023-03-21 13:28:12,884 - train - INFO - Visualizing in TensorBoard...
2023-03-21 13:28:12,910 - train - INFO - Training DONE. Evaluating model...
2023-03-21 13:28:19,815 - train - INFO - DEV set prediction results: loss: 0.589, acc: 0.720, F1_weighted: 0.695, F1_macro: 0.426, F1_micro: 0.720, recall: 0.720, precision: 0.685, best_thresh: 0.500
2023-03-21 13:28:30,088 - train - INFO - TEST set prediction results: loss: 1.043, acc: 0.626, F1_weighted: 0.599, F1_macro: 0.511, F1_micro: 0.626, recall: 0.626, precision: 0.620, best_thresh: 0.500
