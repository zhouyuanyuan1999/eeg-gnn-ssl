2023-03-20 23:03:44,865 - train - INFO - Log directory: ./model_saved/train/train-05
2023-03-20 23:03:44,869 - train - INFO - Args: {
    "cl_decay_steps": 3000,
    "cuda": true,
    "data_augment": true,
    "dcgru_activation": "tanh",
    "do_train": true,
    "dropout": 0.5,
    "eval_every": 1,
    "filter_type": "dual_random_walk",
    "fine_tune": false,
    "graph_type": "individual",
    "input_dim": 200,
    "input_dir": "../tusz_resampled/",
    "l2_wd": 0.0005,
    "load_model_path": null,
    "lr_init": 0.0003,
    "max_diffusion_step": 2,
    "max_grad_norm": 5.0,
    "max_seq_len": 12,
    "maximize_metric": true,
    "metric_avg": "weighted",
    "metric_name": "F1_macro",
    "model_name": "dcrnn",
    "num_classes": 4,
    "num_epochs": 60,
    "num_nodes": 19,
    "num_rnn_layers": 2,
    "num_workers": 8,
    "output_dim": 100,
    "output_seq_len": 12,
    "patience": 5,
    "preproc_dir": null,
    "pretrained_num_rnn_layers": 3,
    "rand_seed": 123,
    "raw_data_dir": "../tusz_raw/",
    "rnn_units": 64,
    "save_dir": "./model_saved/train/train-05",
    "task": "classification",
    "test_batch_size": 128,
    "time_step_size": 1,
    "top_k": 3,
    "train_batch_size": 40,
    "use_curriculum_learning": false,
    "use_fft": false
}
2023-03-20 23:03:44,869 - train - INFO - Building dataset...
2023-03-20 23:04:12,200 - train - INFO - Building model...
2023-03-20 23:04:12,206 - train - INFO - Total number of trainable parameters: 376964
2023-03-20 23:04:13,753 - train - INFO - Saver will maximize F1_macro...
2023-03-20 23:04:13,753 - train - INFO - Training...
2023-03-20 23:04:13,754 - train - INFO - Starting epoch 1...
2023-03-20 23:04:40,011 - train - INFO - Evaluating at epoch 1...
2023-03-20 23:04:46,845 - train - INFO - New best checkpoint at epoch 1...
2023-03-20 23:04:46,846 - train - INFO - Dev loss: 0.785, acc: 0.744, F1_weighted: 0.635, F1_macro: 0.213, F1_micro: 0.744, recall: 0.744, precision: 0.554, best_thresh: 0.500
2023-03-20 23:04:46,846 - train - INFO - Visualizing in TensorBoard...
2023-03-20 23:04:46,848 - train - INFO - Starting epoch 2...
2023-03-20 23:05:12,494 - train - INFO - Evaluating at epoch 2...
2023-03-20 23:05:19,375 - train - INFO - New best checkpoint at epoch 2...
2023-03-20 23:05:19,375 - train - INFO - Dev loss: 0.760, acc: 0.744, F1_weighted: 0.635, F1_macro: 0.213, F1_micro: 0.744, recall: 0.744, precision: 0.554, best_thresh: 0.500
2023-03-20 23:05:19,375 - train - INFO - Visualizing in TensorBoard...
2023-03-20 23:05:19,377 - train - INFO - Starting epoch 3...
2023-03-20 23:05:45,533 - train - INFO - Evaluating at epoch 3...
2023-03-20 23:05:52,353 - train - INFO - New best checkpoint at epoch 3...
2023-03-20 23:05:52,353 - train - INFO - Dev loss: 0.746, acc: 0.744, F1_weighted: 0.635, F1_macro: 0.213, F1_micro: 0.744, recall: 0.744, precision: 0.554, best_thresh: 0.500
2023-03-20 23:05:52,353 - train - INFO - Visualizing in TensorBoard...
2023-03-20 23:05:52,354 - train - INFO - Starting epoch 4...
2023-03-20 23:06:18,852 - train - INFO - Evaluating at epoch 4...
2023-03-20 23:06:25,816 - train - INFO - New best checkpoint at epoch 4...
2023-03-20 23:06:25,816 - train - INFO - Dev loss: 0.738, acc: 0.744, F1_weighted: 0.635, F1_macro: 0.213, F1_micro: 0.744, recall: 0.744, precision: 0.554, best_thresh: 0.500
2023-03-20 23:06:25,816 - train - INFO - Visualizing in TensorBoard...
2023-03-20 23:06:25,817 - train - INFO - Starting epoch 5...
2023-03-20 23:06:51,707 - train - INFO - Evaluating at epoch 5...
2023-03-20 23:06:58,635 - train - INFO - New best checkpoint at epoch 5...
2023-03-20 23:06:58,636 - train - INFO - Dev loss: 0.733, acc: 0.744, F1_weighted: 0.635, F1_macro: 0.213, F1_micro: 0.744, recall: 0.744, precision: 0.554, best_thresh: 0.500
2023-03-20 23:06:58,636 - train - INFO - Visualizing in TensorBoard...
2023-03-20 23:06:58,637 - train - INFO - Starting epoch 6...
2023-03-20 23:07:23,967 - train - INFO - Evaluating at epoch 6...
2023-03-20 23:07:30,797 - train - INFO - New best checkpoint at epoch 6...
2023-03-20 23:07:30,797 - train - INFO - Dev loss: 0.726, acc: 0.747, F1_weighted: 0.641, F1_macro: 0.219, F1_micro: 0.747, recall: 0.747, precision: 0.767, best_thresh: 0.500
2023-03-20 23:07:30,797 - train - INFO - Visualizing in TensorBoard...
2023-03-20 23:07:30,798 - train - INFO - Starting epoch 7...
2023-03-20 23:07:56,418 - train - INFO - Evaluating at epoch 7...
2023-03-20 23:08:03,203 - train - INFO - New best checkpoint at epoch 7...
2023-03-20 23:08:03,204 - train - INFO - Dev loss: 0.717, acc: 0.747, F1_weighted: 0.641, F1_macro: 0.219, F1_micro: 0.747, recall: 0.747, precision: 0.767, best_thresh: 0.500
2023-03-20 23:08:03,204 - train - INFO - Visualizing in TensorBoard...
2023-03-20 23:08:03,205 - train - INFO - Starting epoch 8...
2023-03-20 23:08:28,683 - train - INFO - Evaluating at epoch 8...
2023-03-20 23:08:35,496 - train - INFO - New best checkpoint at epoch 8...
2023-03-20 23:08:35,496 - train - INFO - Dev loss: 0.712, acc: 0.744, F1_weighted: 0.676, F1_macro: 0.262, F1_micro: 0.744, recall: 0.744, precision: 0.660, best_thresh: 0.500
2023-03-20 23:08:35,497 - train - INFO - Visualizing in TensorBoard...
2023-03-20 23:08:35,498 - train - INFO - Starting epoch 9...
2023-03-20 23:09:01,725 - train - INFO - Evaluating at epoch 9...
2023-03-20 23:09:08,546 - train - INFO - New best checkpoint at epoch 9...
2023-03-20 23:09:08,547 - train - INFO - Dev loss: 0.702, acc: 0.764, F1_weighted: 0.692, F1_macro: 0.273, F1_micro: 0.764, recall: 0.764, precision: 0.716, best_thresh: 0.500
2023-03-20 23:09:08,547 - train - INFO - Visualizing in TensorBoard...
2023-03-20 23:09:08,549 - train - INFO - Starting epoch 10...
2023-03-20 23:09:34,005 - train - INFO - Evaluating at epoch 10...
2023-03-20 23:09:40,960 - train - INFO - New best checkpoint at epoch 10...
2023-03-20 23:09:40,960 - train - INFO - Dev loss: 0.693, acc: 0.778, F1_weighted: 0.726, F1_macro: 0.308, F1_micro: 0.778, recall: 0.778, precision: 0.720, best_thresh: 0.500
2023-03-20 23:09:40,961 - train - INFO - Visualizing in TensorBoard...
2023-03-20 23:09:40,961 - train - INFO - Starting epoch 11...
2023-03-20 23:10:06,481 - train - INFO - Evaluating at epoch 11...
2023-03-20 23:10:13,253 - train - INFO - Dev loss: 0.694, acc: 0.707, F1_weighted: 0.691, F1_macro: 0.303, F1_micro: 0.707, recall: 0.707, precision: 0.677, best_thresh: 0.500
2023-03-20 23:10:13,253 - train - INFO - Visualizing in TensorBoard...
2023-03-20 23:10:13,255 - train - INFO - Starting epoch 12...
2023-03-20 23:10:38,737 - train - INFO - Evaluating at epoch 12...
2023-03-20 23:10:45,844 - train - INFO - Dev loss: 0.688, acc: 0.769, F1_weighted: 0.705, F1_macro: 0.287, F1_micro: 0.769, recall: 0.769, precision: 0.712, best_thresh: 0.500
2023-03-20 23:10:45,844 - train - INFO - Visualizing in TensorBoard...
2023-03-20 23:10:45,846 - train - INFO - Starting epoch 13...
2023-03-20 23:11:11,303 - train - INFO - Evaluating at epoch 13...
2023-03-20 23:11:18,038 - train - INFO - Dev loss: 0.682, acc: 0.767, F1_weighted: 0.703, F1_macro: 0.286, F1_micro: 0.767, recall: 0.767, precision: 0.710, best_thresh: 0.500
2023-03-20 23:11:18,038 - train - INFO - Visualizing in TensorBoard...
2023-03-20 23:11:18,040 - train - INFO - Starting epoch 14...
2023-03-20 23:11:44,103 - train - INFO - Evaluating at epoch 14...
2023-03-20 23:11:50,894 - train - INFO - Dev loss: 0.678, acc: 0.780, F1_weighted: 0.724, F1_macro: 0.305, F1_micro: 0.780, recall: 0.780, precision: 0.728, best_thresh: 0.500
2023-03-20 23:11:50,894 - train - INFO - Visualizing in TensorBoard...
2023-03-20 23:11:50,896 - train - INFO - Starting epoch 15...
2023-03-20 23:12:16,599 - train - INFO - Evaluating at epoch 15...
2023-03-20 23:12:23,340 - train - INFO - New best checkpoint at epoch 15...
2023-03-20 23:12:23,340 - train - INFO - Dev loss: 0.676, acc: 0.760, F1_weighted: 0.698, F1_macro: 0.322, F1_micro: 0.760, recall: 0.760, precision: 0.713, best_thresh: 0.500
2023-03-20 23:12:23,341 - train - INFO - Visualizing in TensorBoard...
2023-03-20 23:12:23,342 - train - INFO - Starting epoch 16...
2023-03-20 23:12:48,932 - train - INFO - Evaluating at epoch 16...
2023-03-20 23:12:55,804 - train - INFO - Dev loss: 0.673, acc: 0.769, F1_weighted: 0.724, F1_macro: 0.311, F1_micro: 0.769, recall: 0.769, precision: 0.709, best_thresh: 0.500
2023-03-20 23:12:55,804 - train - INFO - Visualizing in TensorBoard...
2023-03-20 23:12:55,806 - train - INFO - Starting epoch 17...
2023-03-20 23:13:21,036 - train - INFO - Evaluating at epoch 17...
2023-03-20 23:13:28,249 - train - INFO - New best checkpoint at epoch 17...
2023-03-20 23:13:28,249 - train - INFO - Dev loss: 0.670, acc: 0.771, F1_weighted: 0.727, F1_macro: 0.348, F1_micro: 0.771, recall: 0.771, precision: 0.721, best_thresh: 0.500
2023-03-20 23:13:28,250 - train - INFO - Visualizing in TensorBoard...
2023-03-20 23:13:28,252 - train - INFO - Starting epoch 18...
2023-03-20 23:13:53,848 - train - INFO - Evaluating at epoch 18...
2023-03-20 23:14:00,536 - train - INFO - Dev loss: 0.670, acc: 0.773, F1_weighted: 0.708, F1_macro: 0.321, F1_micro: 0.773, recall: 0.773, precision: 0.738, best_thresh: 0.500
2023-03-20 23:14:00,536 - train - INFO - Visualizing in TensorBoard...
2023-03-20 23:14:00,537 - train - INFO - Starting epoch 19...
2023-03-20 23:14:26,158 - train - INFO - Evaluating at epoch 19...
2023-03-20 23:14:33,456 - train - INFO - New best checkpoint at epoch 19...
2023-03-20 23:14:33,457 - train - INFO - Dev loss: 0.668, acc: 0.778, F1_weighted: 0.727, F1_macro: 0.351, F1_micro: 0.778, recall: 0.778, precision: 0.743, best_thresh: 0.500
2023-03-20 23:14:33,457 - train - INFO - Visualizing in TensorBoard...
2023-03-20 23:14:33,458 - train - INFO - Starting epoch 20...
2023-03-20 23:14:59,162 - train - INFO - Evaluating at epoch 20...
2023-03-20 23:15:06,349 - train - INFO - Dev loss: 0.669, acc: 0.724, F1_weighted: 0.703, F1_macro: 0.338, F1_micro: 0.724, recall: 0.724, precision: 0.687, best_thresh: 0.500
2023-03-20 23:15:06,350 - train - INFO - Visualizing in TensorBoard...
2023-03-20 23:15:06,352 - train - INFO - Starting epoch 21...
2023-03-20 23:15:32,113 - train - INFO - Evaluating at epoch 21...
2023-03-20 23:15:39,034 - train - INFO - New best checkpoint at epoch 21...
2023-03-20 23:15:39,035 - train - INFO - Dev loss: 0.666, acc: 0.764, F1_weighted: 0.723, F1_macro: 0.379, F1_micro: 0.764, recall: 0.764, precision: 0.718, best_thresh: 0.500
2023-03-20 23:15:39,035 - train - INFO - Visualizing in TensorBoard...
2023-03-20 23:15:39,037 - train - INFO - Starting epoch 22...
2023-03-20 23:16:04,815 - train - INFO - Evaluating at epoch 22...
2023-03-20 23:16:11,949 - train - INFO - Dev loss: 0.667, acc: 0.729, F1_weighted: 0.696, F1_macro: 0.339, F1_micro: 0.729, recall: 0.729, precision: 0.678, best_thresh: 0.500
2023-03-20 23:16:11,949 - train - INFO - Visualizing in TensorBoard...
2023-03-20 23:16:11,951 - train - INFO - Starting epoch 23...
2023-03-20 23:16:37,736 - train - INFO - Evaluating at epoch 23...
2023-03-20 23:16:44,762 - train - INFO - Dev loss: 0.666, acc: 0.753, F1_weighted: 0.701, F1_macro: 0.314, F1_micro: 0.753, recall: 0.753, precision: 0.689, best_thresh: 0.500
2023-03-20 23:16:44,763 - train - INFO - Visualizing in TensorBoard...
2023-03-20 23:16:44,764 - train - INFO - Starting epoch 24...
2023-03-20 23:17:10,967 - train - INFO - Evaluating at epoch 24...
2023-03-20 23:17:17,917 - train - INFO - Dev loss: 0.667, acc: 0.736, F1_weighted: 0.686, F1_macro: 0.338, F1_micro: 0.736, recall: 0.736, precision: 0.673, best_thresh: 0.500
2023-03-20 23:17:17,917 - train - INFO - Visualizing in TensorBoard...
2023-03-20 23:17:17,919 - train - INFO - Starting epoch 25...
2023-03-20 23:17:43,505 - train - INFO - Evaluating at epoch 25...
2023-03-20 23:17:50,732 - train - INFO - Dev loss: 0.665, acc: 0.760, F1_weighted: 0.724, F1_macro: 0.340, F1_micro: 0.760, recall: 0.760, precision: 0.709, best_thresh: 0.500
2023-03-20 23:17:50,732 - train - INFO - Visualizing in TensorBoard...
2023-03-20 23:17:50,734 - train - INFO - Starting epoch 26...
2023-03-20 23:18:16,142 - train - INFO - Evaluating at epoch 26...
2023-03-20 23:18:23,303 - train - INFO - Dev loss: 0.665, acc: 0.758, F1_weighted: 0.711, F1_macro: 0.371, F1_micro: 0.758, recall: 0.758, precision: 0.705, best_thresh: 0.500
2023-03-20 23:18:23,304 - train - INFO - Visualizing in TensorBoard...
2023-03-20 23:18:23,305 - train - INFO - Starting epoch 27...
2023-03-20 23:18:48,748 - train - INFO - Evaluating at epoch 27...
2023-03-20 23:18:55,494 - train - INFO - Dev loss: 0.665, acc: 0.751, F1_weighted: 0.715, F1_macro: 0.302, F1_micro: 0.751, recall: 0.751, precision: 0.697, best_thresh: 0.500
2023-03-20 23:18:55,495 - train - INFO - Visualizing in TensorBoard...
2023-03-20 23:18:55,496 - train - INFO - Starting epoch 28...
2023-03-20 23:19:21,991 - train - INFO - Evaluating at epoch 28...
2023-03-20 23:19:28,713 - train - INFO - Dev loss: 0.665, acc: 0.749, F1_weighted: 0.711, F1_macro: 0.349, F1_micro: 0.749, recall: 0.749, precision: 0.695, best_thresh: 0.500
2023-03-20 23:19:28,713 - train - INFO - Visualizing in TensorBoard...
2023-03-20 23:19:28,714 - train - INFO - Starting epoch 29...
2023-03-20 23:19:54,695 - train - INFO - Evaluating at epoch 29...
2023-03-20 23:20:01,508 - train - INFO - Dev loss: 0.665, acc: 0.760, F1_weighted: 0.704, F1_macro: 0.353, F1_micro: 0.760, recall: 0.760, precision: 0.705, best_thresh: 0.500
2023-03-20 23:20:01,509 - train - INFO - Visualizing in TensorBoard...
2023-03-20 23:20:01,511 - train - INFO - Starting epoch 30...
2023-03-20 23:20:26,950 - train - INFO - Evaluating at epoch 30...
2023-03-20 23:20:33,681 - train - INFO - Dev loss: 0.666, acc: 0.731, F1_weighted: 0.702, F1_macro: 0.325, F1_micro: 0.731, recall: 0.731, precision: 0.684, best_thresh: 0.500
2023-03-20 23:20:33,681 - train - INFO - Visualizing in TensorBoard...
2023-03-20 23:20:33,682 - train - INFO - Starting epoch 31...
2023-03-20 23:20:59,423 - train - INFO - Evaluating at epoch 31...
2023-03-20 23:21:06,284 - train - INFO - Dev loss: 0.667, acc: 0.733, F1_weighted: 0.703, F1_macro: 0.365, F1_micro: 0.733, recall: 0.733, precision: 0.685, best_thresh: 0.500
2023-03-20 23:21:06,285 - train - INFO - Visualizing in TensorBoard...
2023-03-20 23:21:06,286 - train - INFO - Starting epoch 32...
2023-03-20 23:21:32,136 - train - INFO - Evaluating at epoch 32...
2023-03-20 23:21:38,852 - train - INFO - Dev loss: 0.667, acc: 0.753, F1_weighted: 0.721, F1_macro: 0.336, F1_micro: 0.753, recall: 0.753, precision: 0.705, best_thresh: 0.500
2023-03-20 23:21:38,853 - train - INFO - Visualizing in TensorBoard...
2023-03-20 23:21:38,854 - train - INFO - Starting epoch 33...
2023-03-20 23:22:04,451 - train - INFO - Evaluating at epoch 33...
2023-03-20 23:22:11,273 - train - INFO - Dev loss: 0.668, acc: 0.747, F1_weighted: 0.707, F1_macro: 0.346, F1_micro: 0.747, recall: 0.747, precision: 0.692, best_thresh: 0.500
2023-03-20 23:22:11,273 - train - INFO - Visualizing in TensorBoard...
2023-03-20 23:22:11,274 - train - INFO - Starting epoch 34...
2023-03-20 23:22:37,595 - train - INFO - Evaluating at epoch 34...
2023-03-20 23:22:44,411 - train - INFO - Dev loss: 0.669, acc: 0.756, F1_weighted: 0.716, F1_macro: 0.370, F1_micro: 0.756, recall: 0.756, precision: 0.705, best_thresh: 0.500
2023-03-20 23:22:44,411 - train - INFO - Visualizing in TensorBoard...
2023-03-20 23:22:44,412 - train - INFO - Starting epoch 35...
2023-03-20 23:23:09,832 - train - INFO - Evaluating at epoch 35...
2023-03-20 23:23:16,811 - train - INFO - Dev loss: 0.670, acc: 0.753, F1_weighted: 0.716, F1_macro: 0.368, F1_micro: 0.753, recall: 0.753, precision: 0.706, best_thresh: 0.500
2023-03-20 23:23:16,812 - train - INFO - Visualizing in TensorBoard...
2023-03-20 23:23:16,813 - train - INFO - Starting epoch 36...
2023-03-20 23:23:42,876 - train - INFO - Evaluating at epoch 36...
2023-03-20 23:23:49,801 - train - INFO - Dev loss: 0.672, acc: 0.733, F1_weighted: 0.713, F1_macro: 0.357, F1_micro: 0.733, recall: 0.733, precision: 0.698, best_thresh: 0.500
2023-03-20 23:23:49,801 - train - INFO - Visualizing in TensorBoard...
2023-03-20 23:23:49,802 - train - INFO - Starting epoch 37...
2023-03-20 23:24:16,312 - train - INFO - Evaluating at epoch 37...
2023-03-20 23:24:23,193 - train - INFO - Dev loss: 0.675, acc: 0.720, F1_weighted: 0.699, F1_macro: 0.348, F1_micro: 0.720, recall: 0.720, precision: 0.683, best_thresh: 0.500
2023-03-20 23:24:23,193 - train - INFO - Visualizing in TensorBoard...
2023-03-20 23:24:23,216 - train - INFO - Training DONE. Evaluating model...
2023-03-20 23:24:29,656 - train - INFO - DEV set prediction results: loss: 0.596, acc: 0.764, F1_weighted: 0.723, F1_macro: 0.379, F1_micro: 0.764, recall: 0.764, precision: 0.718, best_thresh: 0.500
2023-03-20 23:24:38,073 - train - INFO - TEST set prediction results: loss: 0.768, acc: 0.578, F1_weighted: 0.482, F1_macro: 0.312, F1_micro: 0.578, recall: 0.578, precision: 0.585, best_thresh: 0.500
