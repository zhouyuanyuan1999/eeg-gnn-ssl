2023-03-20 21:53:22,838 - train - INFO - Log directory: ./model_saved/train/train-04
2023-03-20 21:53:22,841 - train - INFO - Args: {
    "cl_decay_steps": 3000,
    "cuda": true,
    "data_augment": true,
    "dcgru_activation": "tanh",
    "do_train": true,
    "dropout": 0.5,
    "eval_every": 1,
    "filter_type": "dual_random_walk",
    "fine_tune": false,
    "graph_type": "individual",
    "input_dim": 200,
    "input_dir": "../tusz_resampled/",
    "l2_wd": 0.0005,
    "load_model_path": null,
    "lr_init": 0.0003,
    "max_diffusion_step": 2,
    "max_grad_norm": 5.0,
    "max_seq_len": 12,
    "maximize_metric": true,
    "metric_avg": "weighted",
    "metric_name": "F1_weighted",
    "model_name": "dcrnn",
    "num_classes": 4,
    "num_epochs": 60,
    "num_nodes": 19,
    "num_rnn_layers": 2,
    "num_workers": 8,
    "output_dim": 100,
    "output_seq_len": 12,
    "patience": 5,
    "preproc_dir": null,
    "pretrained_num_rnn_layers": 3,
    "rand_seed": 123,
    "raw_data_dir": "../tusz_raw/",
    "rnn_units": 64,
    "save_dir": "./model_saved/train/train-04",
    "task": "classification",
    "test_batch_size": 128,
    "time_step_size": 1,
    "top_k": 3,
    "train_batch_size": 40,
    "use_curriculum_learning": false,
    "use_fft": false
}
2023-03-20 21:53:22,841 - train - INFO - Building dataset...
2023-03-20 21:53:48,639 - train - INFO - Building model...
2023-03-20 21:53:48,642 - train - INFO - Total number of trainable parameters: 376964
2023-03-20 21:53:49,772 - train - INFO - Saver will maximize F1_weighted...
2023-03-20 21:53:49,773 - train - INFO - Training...
2023-03-20 21:53:49,773 - train - INFO - Starting epoch 1...
2023-03-20 21:54:15,806 - train - INFO - Evaluating at epoch 1...
2023-03-20 21:54:22,568 - train - INFO - New best checkpoint at epoch 1...
2023-03-20 21:54:22,569 - train - INFO - Dev loss: 0.785, acc: 0.744, F1_weighted: 0.635, F1_macro: 0.213, F1_micro: 0.744, recall: 0.744, precision: 0.554, best_thresh: 0.500
2023-03-20 21:54:22,569 - train - INFO - Visualizing in TensorBoard...
2023-03-20 21:54:22,570 - train - INFO - Starting epoch 2...
2023-03-20 21:54:49,646 - train - INFO - Evaluating at epoch 2...
2023-03-20 21:54:56,746 - train - INFO - New best checkpoint at epoch 2...
2023-03-20 21:54:56,747 - train - INFO - Dev loss: 0.760, acc: 0.744, F1_weighted: 0.635, F1_macro: 0.213, F1_micro: 0.744, recall: 0.744, precision: 0.554, best_thresh: 0.500
2023-03-20 21:54:56,747 - train - INFO - Visualizing in TensorBoard...
2023-03-20 21:54:56,748 - train - INFO - Starting epoch 3...
2023-03-20 21:55:22,483 - train - INFO - Evaluating at epoch 3...
2023-03-20 21:55:29,517 - train - INFO - New best checkpoint at epoch 3...
2023-03-20 21:55:29,517 - train - INFO - Dev loss: 0.746, acc: 0.744, F1_weighted: 0.635, F1_macro: 0.213, F1_micro: 0.744, recall: 0.744, precision: 0.554, best_thresh: 0.500
2023-03-20 21:55:29,518 - train - INFO - Visualizing in TensorBoard...
2023-03-20 21:55:29,518 - train - INFO - Starting epoch 4...
2023-03-20 21:55:55,466 - train - INFO - Evaluating at epoch 4...
2023-03-20 21:56:02,716 - train - INFO - New best checkpoint at epoch 4...
2023-03-20 21:56:02,717 - train - INFO - Dev loss: 0.738, acc: 0.744, F1_weighted: 0.635, F1_macro: 0.213, F1_micro: 0.744, recall: 0.744, precision: 0.554, best_thresh: 0.500
2023-03-20 21:56:02,717 - train - INFO - Visualizing in TensorBoard...
2023-03-20 21:56:02,718 - train - INFO - Starting epoch 5...
2023-03-20 21:56:28,704 - train - INFO - Evaluating at epoch 5...
2023-03-20 21:56:35,516 - train - INFO - New best checkpoint at epoch 5...
2023-03-20 21:56:35,517 - train - INFO - Dev loss: 0.733, acc: 0.744, F1_weighted: 0.635, F1_macro: 0.213, F1_micro: 0.744, recall: 0.744, precision: 0.554, best_thresh: 0.500
2023-03-20 21:56:35,517 - train - INFO - Visualizing in TensorBoard...
2023-03-20 21:56:35,519 - train - INFO - Starting epoch 6...
2023-03-20 21:57:01,238 - train - INFO - Evaluating at epoch 6...
2023-03-20 21:57:08,520 - train - INFO - New best checkpoint at epoch 6...
2023-03-20 21:57:08,521 - train - INFO - Dev loss: 0.726, acc: 0.747, F1_weighted: 0.641, F1_macro: 0.219, F1_micro: 0.747, recall: 0.747, precision: 0.767, best_thresh: 0.500
2023-03-20 21:57:08,521 - train - INFO - Visualizing in TensorBoard...
2023-03-20 21:57:08,523 - train - INFO - Starting epoch 7...
2023-03-20 21:57:34,224 - train - INFO - Evaluating at epoch 7...
2023-03-20 21:57:41,117 - train - INFO - New best checkpoint at epoch 7...
2023-03-20 21:57:41,117 - train - INFO - Dev loss: 0.717, acc: 0.747, F1_weighted: 0.641, F1_macro: 0.219, F1_micro: 0.747, recall: 0.747, precision: 0.767, best_thresh: 0.500
2023-03-20 21:57:41,118 - train - INFO - Visualizing in TensorBoard...
2023-03-20 21:57:41,120 - train - INFO - Starting epoch 8...
2023-03-20 21:58:07,455 - train - INFO - Evaluating at epoch 8...
2023-03-20 21:58:14,267 - train - INFO - New best checkpoint at epoch 8...
2023-03-20 21:58:14,268 - train - INFO - Dev loss: 0.712, acc: 0.744, F1_weighted: 0.676, F1_macro: 0.262, F1_micro: 0.744, recall: 0.744, precision: 0.660, best_thresh: 0.500
2023-03-20 21:58:14,268 - train - INFO - Visualizing in TensorBoard...
2023-03-20 21:58:14,269 - train - INFO - Starting epoch 9...
2023-03-20 21:58:39,881 - train - INFO - Evaluating at epoch 9...
2023-03-20 21:58:46,686 - train - INFO - New best checkpoint at epoch 9...
2023-03-20 21:58:46,686 - train - INFO - Dev loss: 0.702, acc: 0.764, F1_weighted: 0.692, F1_macro: 0.273, F1_micro: 0.764, recall: 0.764, precision: 0.716, best_thresh: 0.500
2023-03-20 21:58:46,686 - train - INFO - Visualizing in TensorBoard...
2023-03-20 21:58:46,688 - train - INFO - Starting epoch 10...
2023-03-20 21:59:12,607 - train - INFO - Evaluating at epoch 10...
2023-03-20 21:59:19,477 - train - INFO - New best checkpoint at epoch 10...
2023-03-20 21:59:19,478 - train - INFO - Dev loss: 0.693, acc: 0.778, F1_weighted: 0.726, F1_macro: 0.308, F1_micro: 0.778, recall: 0.778, precision: 0.720, best_thresh: 0.500
2023-03-20 21:59:19,478 - train - INFO - Visualizing in TensorBoard...
2023-03-20 21:59:19,479 - train - INFO - Starting epoch 11...
2023-03-20 21:59:45,350 - train - INFO - Evaluating at epoch 11...
2023-03-20 21:59:52,193 - train - INFO - Dev loss: 0.694, acc: 0.707, F1_weighted: 0.691, F1_macro: 0.303, F1_micro: 0.707, recall: 0.707, precision: 0.677, best_thresh: 0.500
2023-03-20 21:59:52,194 - train - INFO - Visualizing in TensorBoard...
2023-03-20 21:59:52,195 - train - INFO - Starting epoch 12...
2023-03-20 22:00:18,161 - train - INFO - Evaluating at epoch 12...
2023-03-20 22:00:25,211 - train - INFO - Dev loss: 0.688, acc: 0.769, F1_weighted: 0.705, F1_macro: 0.287, F1_micro: 0.769, recall: 0.769, precision: 0.712, best_thresh: 0.500
2023-03-20 22:00:25,212 - train - INFO - Visualizing in TensorBoard...
2023-03-20 22:00:25,214 - train - INFO - Starting epoch 13...
2023-03-20 22:00:51,331 - train - INFO - Evaluating at epoch 13...
2023-03-20 22:00:58,175 - train - INFO - Dev loss: 0.682, acc: 0.767, F1_weighted: 0.703, F1_macro: 0.286, F1_micro: 0.767, recall: 0.767, precision: 0.710, best_thresh: 0.500
2023-03-20 22:00:58,176 - train - INFO - Visualizing in TensorBoard...
2023-03-20 22:00:58,177 - train - INFO - Starting epoch 14...
2023-03-20 22:01:24,114 - train - INFO - Evaluating at epoch 14...
2023-03-20 22:01:31,356 - train - INFO - Dev loss: 0.678, acc: 0.780, F1_weighted: 0.724, F1_macro: 0.305, F1_micro: 0.780, recall: 0.780, precision: 0.728, best_thresh: 0.500
2023-03-20 22:01:31,356 - train - INFO - Visualizing in TensorBoard...
2023-03-20 22:01:31,357 - train - INFO - Starting epoch 15...
2023-03-20 22:01:58,036 - train - INFO - Evaluating at epoch 15...
2023-03-20 22:02:05,353 - train - INFO - Dev loss: 0.676, acc: 0.760, F1_weighted: 0.698, F1_macro: 0.322, F1_micro: 0.760, recall: 0.760, precision: 0.713, best_thresh: 0.500
2023-03-20 22:02:05,353 - train - INFO - Visualizing in TensorBoard...
2023-03-20 22:02:05,355 - train - INFO - Starting epoch 16...
2023-03-20 22:02:31,259 - train - INFO - Evaluating at epoch 16...
2023-03-20 22:02:38,357 - train - INFO - Dev loss: 0.673, acc: 0.769, F1_weighted: 0.724, F1_macro: 0.311, F1_micro: 0.769, recall: 0.769, precision: 0.709, best_thresh: 0.500
2023-03-20 22:02:38,357 - train - INFO - Visualizing in TensorBoard...
2023-03-20 22:02:38,358 - train - INFO - Starting epoch 17...
2023-03-20 22:03:04,380 - train - INFO - Evaluating at epoch 17...
2023-03-20 22:03:11,579 - train - INFO - New best checkpoint at epoch 17...
2023-03-20 22:03:11,580 - train - INFO - Dev loss: 0.670, acc: 0.771, F1_weighted: 0.727, F1_macro: 0.348, F1_micro: 0.771, recall: 0.771, precision: 0.721, best_thresh: 0.500
2023-03-20 22:03:11,580 - train - INFO - Visualizing in TensorBoard...
2023-03-20 22:03:11,582 - train - INFO - Starting epoch 18...
2023-03-20 22:03:37,698 - train - INFO - Evaluating at epoch 18...
2023-03-20 22:03:44,561 - train - INFO - Dev loss: 0.670, acc: 0.773, F1_weighted: 0.708, F1_macro: 0.321, F1_micro: 0.773, recall: 0.773, precision: 0.738, best_thresh: 0.500
2023-03-20 22:03:44,561 - train - INFO - Visualizing in TensorBoard...
2023-03-20 22:03:44,563 - train - INFO - Starting epoch 19...
2023-03-20 22:04:10,753 - train - INFO - Evaluating at epoch 19...
2023-03-20 22:04:17,804 - train - INFO - New best checkpoint at epoch 19...
2023-03-20 22:04:17,804 - train - INFO - Dev loss: 0.668, acc: 0.778, F1_weighted: 0.727, F1_macro: 0.351, F1_micro: 0.778, recall: 0.778, precision: 0.743, best_thresh: 0.500
2023-03-20 22:04:17,805 - train - INFO - Visualizing in TensorBoard...
2023-03-20 22:04:17,806 - train - INFO - Starting epoch 20...
2023-03-20 22:04:44,468 - train - INFO - Evaluating at epoch 20...
2023-03-20 22:04:51,217 - train - INFO - Dev loss: 0.669, acc: 0.724, F1_weighted: 0.703, F1_macro: 0.338, F1_micro: 0.724, recall: 0.724, precision: 0.687, best_thresh: 0.500
2023-03-20 22:04:51,218 - train - INFO - Visualizing in TensorBoard...
2023-03-20 22:04:51,219 - train - INFO - Starting epoch 21...
2023-03-20 22:05:17,446 - train - INFO - Evaluating at epoch 21...
2023-03-20 22:05:24,303 - train - INFO - Dev loss: 0.666, acc: 0.764, F1_weighted: 0.723, F1_macro: 0.379, F1_micro: 0.764, recall: 0.764, precision: 0.718, best_thresh: 0.500
2023-03-20 22:05:24,303 - train - INFO - Visualizing in TensorBoard...
2023-03-20 22:05:24,304 - train - INFO - Starting epoch 22...
2023-03-20 22:05:50,185 - train - INFO - Evaluating at epoch 22...
2023-03-20 22:05:57,081 - train - INFO - Dev loss: 0.667, acc: 0.729, F1_weighted: 0.696, F1_macro: 0.339, F1_micro: 0.729, recall: 0.729, precision: 0.678, best_thresh: 0.500
2023-03-20 22:05:57,081 - train - INFO - Visualizing in TensorBoard...
2023-03-20 22:05:57,083 - train - INFO - Starting epoch 23...
2023-03-20 22:06:23,091 - train - INFO - Evaluating at epoch 23...
2023-03-20 22:06:30,287 - train - INFO - Dev loss: 0.666, acc: 0.753, F1_weighted: 0.701, F1_macro: 0.314, F1_micro: 0.753, recall: 0.753, precision: 0.689, best_thresh: 0.500
2023-03-20 22:06:30,288 - train - INFO - Visualizing in TensorBoard...
2023-03-20 22:06:30,289 - train - INFO - Starting epoch 24...
2023-03-20 22:06:56,063 - train - INFO - Evaluating at epoch 24...
2023-03-20 22:07:03,055 - train - INFO - Dev loss: 0.667, acc: 0.736, F1_weighted: 0.686, F1_macro: 0.338, F1_micro: 0.736, recall: 0.736, precision: 0.673, best_thresh: 0.500
2023-03-20 22:07:03,055 - train - INFO - Visualizing in TensorBoard...
2023-03-20 22:07:03,056 - train - INFO - Starting epoch 25...
2023-03-20 22:07:29,089 - train - INFO - Evaluating at epoch 25...
2023-03-20 22:07:36,059 - train - INFO - Dev loss: 0.665, acc: 0.760, F1_weighted: 0.724, F1_macro: 0.340, F1_micro: 0.760, recall: 0.760, precision: 0.709, best_thresh: 0.500
2023-03-20 22:07:36,059 - train - INFO - Visualizing in TensorBoard...
2023-03-20 22:07:36,060 - train - INFO - Starting epoch 26...
2023-03-20 22:08:02,235 - train - INFO - Evaluating at epoch 26...
2023-03-20 22:08:09,080 - train - INFO - Dev loss: 0.665, acc: 0.758, F1_weighted: 0.711, F1_macro: 0.371, F1_micro: 0.758, recall: 0.758, precision: 0.705, best_thresh: 0.500
2023-03-20 22:08:09,081 - train - INFO - Visualizing in TensorBoard...
2023-03-20 22:08:09,082 - train - INFO - Starting epoch 27...
2023-03-20 22:08:35,018 - train - INFO - Evaluating at epoch 27...
2023-03-20 22:08:42,068 - train - INFO - Dev loss: 0.665, acc: 0.751, F1_weighted: 0.715, F1_macro: 0.302, F1_micro: 0.751, recall: 0.751, precision: 0.697, best_thresh: 0.500
2023-03-20 22:08:42,068 - train - INFO - Visualizing in TensorBoard...
2023-03-20 22:08:42,070 - train - INFO - Starting epoch 28...
2023-03-20 22:09:08,447 - train - INFO - Evaluating at epoch 28...
2023-03-20 22:09:15,225 - train - INFO - Dev loss: 0.665, acc: 0.749, F1_weighted: 0.711, F1_macro: 0.349, F1_micro: 0.749, recall: 0.749, precision: 0.695, best_thresh: 0.500
2023-03-20 22:09:15,226 - train - INFO - Visualizing in TensorBoard...
2023-03-20 22:09:15,227 - train - INFO - Starting epoch 29...
2023-03-20 22:09:41,064 - train - INFO - Evaluating at epoch 29...
2023-03-20 22:09:48,391 - train - INFO - Dev loss: 0.665, acc: 0.760, F1_weighted: 0.704, F1_macro: 0.353, F1_micro: 0.760, recall: 0.760, precision: 0.705, best_thresh: 0.500
2023-03-20 22:09:48,392 - train - INFO - Visualizing in TensorBoard...
2023-03-20 22:09:48,393 - train - INFO - Starting epoch 30...
2023-03-20 22:10:14,150 - train - INFO - Evaluating at epoch 30...
2023-03-20 22:10:21,194 - train - INFO - Dev loss: 0.666, acc: 0.731, F1_weighted: 0.702, F1_macro: 0.325, F1_micro: 0.731, recall: 0.731, precision: 0.684, best_thresh: 0.500
2023-03-20 22:10:21,194 - train - INFO - Visualizing in TensorBoard...
2023-03-20 22:10:21,195 - train - INFO - Starting epoch 31...
2023-03-20 22:10:47,361 - train - INFO - Evaluating at epoch 31...
2023-03-20 22:10:54,195 - train - INFO - Dev loss: 0.667, acc: 0.733, F1_weighted: 0.703, F1_macro: 0.365, F1_micro: 0.733, recall: 0.733, precision: 0.685, best_thresh: 0.500
2023-03-20 22:10:54,196 - train - INFO - Visualizing in TensorBoard...
2023-03-20 22:10:54,198 - train - INFO - Starting epoch 32...
2023-03-20 22:11:20,098 - train - INFO - Evaluating at epoch 32...
2023-03-20 22:11:26,788 - train - INFO - Dev loss: 0.667, acc: 0.753, F1_weighted: 0.721, F1_macro: 0.336, F1_micro: 0.753, recall: 0.753, precision: 0.705, best_thresh: 0.500
2023-03-20 22:11:26,788 - train - INFO - Visualizing in TensorBoard...
2023-03-20 22:11:26,790 - train - INFO - Starting epoch 33...
2023-03-20 22:11:52,500 - train - INFO - Evaluating at epoch 33...
2023-03-20 22:11:59,362 - train - INFO - Dev loss: 0.668, acc: 0.747, F1_weighted: 0.707, F1_macro: 0.346, F1_micro: 0.747, recall: 0.747, precision: 0.692, best_thresh: 0.500
2023-03-20 22:11:59,363 - train - INFO - Visualizing in TensorBoard...
2023-03-20 22:11:59,364 - train - INFO - Starting epoch 34...
2023-03-20 22:12:25,197 - train - INFO - Evaluating at epoch 34...
2023-03-20 22:12:31,966 - train - INFO - Dev loss: 0.669, acc: 0.756, F1_weighted: 0.716, F1_macro: 0.370, F1_micro: 0.756, recall: 0.756, precision: 0.705, best_thresh: 0.500
2023-03-20 22:12:31,967 - train - INFO - Visualizing in TensorBoard...
2023-03-20 22:12:31,968 - train - INFO - Starting epoch 35...
2023-03-20 22:12:57,977 - train - INFO - Evaluating at epoch 35...
2023-03-20 22:13:04,963 - train - INFO - Dev loss: 0.670, acc: 0.753, F1_weighted: 0.716, F1_macro: 0.368, F1_micro: 0.753, recall: 0.753, precision: 0.706, best_thresh: 0.500
2023-03-20 22:13:04,963 - train - INFO - Visualizing in TensorBoard...
2023-03-20 22:13:04,964 - train - INFO - Starting epoch 36...
2023-03-20 22:13:30,829 - train - INFO - Evaluating at epoch 36...
2023-03-20 22:13:38,024 - train - INFO - Dev loss: 0.672, acc: 0.733, F1_weighted: 0.713, F1_macro: 0.357, F1_micro: 0.733, recall: 0.733, precision: 0.698, best_thresh: 0.500
2023-03-20 22:13:38,025 - train - INFO - Visualizing in TensorBoard...
2023-03-20 22:13:38,026 - train - INFO - Starting epoch 37...
2023-03-20 22:14:04,058 - train - INFO - Evaluating at epoch 37...
2023-03-20 22:14:10,921 - train - INFO - Dev loss: 0.675, acc: 0.720, F1_weighted: 0.699, F1_macro: 0.348, F1_micro: 0.720, recall: 0.720, precision: 0.683, best_thresh: 0.500
2023-03-20 22:14:10,922 - train - INFO - Visualizing in TensorBoard...
2023-03-20 22:14:10,948 - train - INFO - Training DONE. Evaluating model...
2023-03-20 22:14:17,071 - train - INFO - DEV set prediction results: loss: 0.569, acc: 0.778, F1_weighted: 0.727, F1_macro: 0.351, F1_micro: 0.778, recall: 0.778, precision: 0.743, best_thresh: 0.500
2023-03-20 22:14:25,765 - train - INFO - TEST set prediction results: loss: 1.218, acc: 0.562, F1_weighted: 0.446, F1_macro: 0.229, F1_micro: 0.562, recall: 0.562, precision: 0.462, best_thresh: 0.500
