2023-03-21 13:52:53,473 - train - INFO - Log directory: ./model_saved/train/train-05
2023-03-21 13:52:53,475 - train - INFO - Args: {
    "cl_decay_steps": 3000,
    "cuda": true,
    "data_augment": true,
    "dcgru_activation": "tanh",
    "do_train": true,
    "dropout": 0.5,
    "eval_every": 1,
    "filter_type": "dual_random_walk",
    "fine_tune": false,
    "graph_type": "individual",
    "input_dim": 200,
    "input_dir": "../tusz_resampled/",
    "l2_wd": 0.0005,
    "load_model_path": null,
    "lr_init": 0.0003,
    "max_diffusion_step": 2,
    "max_grad_norm": 5.0,
    "max_seq_len": 12,
    "maximize_metric": true,
    "metric_avg": "weighted",
    "metric_name": "F1_macro",
    "model_name": "dcrnn",
    "num_classes": 4,
    "num_epochs": 60,
    "num_nodes": 19,
    "num_rnn_layers": 2,
    "num_workers": 8,
    "output_dim": 100,
    "output_seq_len": 12,
    "patience": 5,
    "preproc_dir": null,
    "preprocess": "raw_beta",
    "pretrained_num_rnn_layers": 3,
    "rand_seed": 123,
    "raw_data_dir": "../tusz_raw/",
    "rnn_units": 64,
    "save_dir": "./model_saved/train/train-05",
    "task": "classification",
    "test_batch_size": 128,
    "time_step_size": 1,
    "top_k": 3,
    "train_batch_size": 40,
    "use_curriculum_learning": false
}
2023-03-21 13:52:53,475 - train - INFO - Building dataset...
2023-03-21 13:53:20,212 - train - INFO - Building model...
2023-03-21 13:53:20,215 - train - INFO - Total number of trainable parameters: 376964
2023-03-21 13:53:21,247 - train - INFO - Saver will maximize F1_macro...
2023-03-21 13:53:21,248 - train - INFO - Training...
2023-03-21 13:53:21,248 - train - INFO - Starting epoch 1...
2023-03-21 13:53:48,914 - train - INFO - Evaluating at epoch 1...
2023-03-21 13:53:56,452 - train - INFO - New best checkpoint at epoch 1...
2023-03-21 13:53:56,452 - train - INFO - Dev loss: 0.751, acc: 0.744, F1_weighted: 0.635, F1_macro: 0.213, F1_micro: 0.744, recall: 0.744, precision: 0.554, best_thresh: 0.500
2023-03-21 13:53:56,452 - train - INFO - Visualizing in TensorBoard...
2023-03-21 13:53:56,453 - train - INFO - Starting epoch 2...
2023-03-21 13:54:23,605 - train - INFO - Evaluating at epoch 2...
2023-03-21 13:54:31,831 - train - INFO - New best checkpoint at epoch 2...
2023-03-21 13:54:31,831 - train - INFO - Dev loss: 0.725, acc: 0.744, F1_weighted: 0.635, F1_macro: 0.213, F1_micro: 0.744, recall: 0.744, precision: 0.554, best_thresh: 0.500
2023-03-21 13:54:31,832 - train - INFO - Visualizing in TensorBoard...
2023-03-21 13:54:31,833 - train - INFO - Starting epoch 3...
2023-03-21 13:54:58,372 - train - INFO - Evaluating at epoch 3...
2023-03-21 13:55:06,037 - train - INFO - New best checkpoint at epoch 3...
2023-03-21 13:55:06,038 - train - INFO - Dev loss: 0.708, acc: 0.744, F1_weighted: 0.635, F1_macro: 0.213, F1_micro: 0.744, recall: 0.744, precision: 0.554, best_thresh: 0.500
2023-03-21 13:55:06,038 - train - INFO - Visualizing in TensorBoard...
2023-03-21 13:55:06,039 - train - INFO - Starting epoch 4...
2023-03-21 13:55:32,960 - train - INFO - Evaluating at epoch 4...
2023-03-21 13:55:40,627 - train - INFO - New best checkpoint at epoch 4...
2023-03-21 13:55:40,627 - train - INFO - Dev loss: 0.693, acc: 0.744, F1_weighted: 0.635, F1_macro: 0.213, F1_micro: 0.744, recall: 0.744, precision: 0.554, best_thresh: 0.500
2023-03-21 13:55:40,628 - train - INFO - Visualizing in TensorBoard...
2023-03-21 13:55:40,629 - train - INFO - Starting epoch 5...
2023-03-21 13:56:07,439 - train - INFO - Evaluating at epoch 5...
2023-03-21 13:56:14,825 - train - INFO - New best checkpoint at epoch 5...
2023-03-21 13:56:14,826 - train - INFO - Dev loss: 0.680, acc: 0.744, F1_weighted: 0.635, F1_macro: 0.213, F1_micro: 0.744, recall: 0.744, precision: 0.554, best_thresh: 0.500
2023-03-21 13:56:14,826 - train - INFO - Visualizing in TensorBoard...
2023-03-21 13:56:14,828 - train - INFO - Starting epoch 6...
2023-03-21 13:56:41,323 - train - INFO - Evaluating at epoch 6...
2023-03-21 13:56:48,753 - train - INFO - New best checkpoint at epoch 6...
2023-03-21 13:56:48,753 - train - INFO - Dev loss: 0.669, acc: 0.744, F1_weighted: 0.635, F1_macro: 0.213, F1_micro: 0.744, recall: 0.744, precision: 0.554, best_thresh: 0.500
2023-03-21 13:56:48,753 - train - INFO - Visualizing in TensorBoard...
2023-03-21 13:56:48,755 - train - INFO - Starting epoch 7...
2023-03-21 13:57:15,287 - train - INFO - Evaluating at epoch 7...
2023-03-21 13:57:22,785 - train - INFO - New best checkpoint at epoch 7...
2023-03-21 13:57:22,786 - train - INFO - Dev loss: 0.659, acc: 0.744, F1_weighted: 0.637, F1_macro: 0.214, F1_micro: 0.744, recall: 0.744, precision: 0.557, best_thresh: 0.500
2023-03-21 13:57:22,786 - train - INFO - Visualizing in TensorBoard...
2023-03-21 13:57:22,787 - train - INFO - Starting epoch 8...
2023-03-21 13:57:50,211 - train - INFO - Evaluating at epoch 8...
2023-03-21 13:57:57,533 - train - INFO - New best checkpoint at epoch 8...
2023-03-21 13:57:57,534 - train - INFO - Dev loss: 0.650, acc: 0.744, F1_weighted: 0.637, F1_macro: 0.214, F1_micro: 0.744, recall: 0.744, precision: 0.557, best_thresh: 0.500
2023-03-21 13:57:57,534 - train - INFO - Visualizing in TensorBoard...
2023-03-21 13:57:57,535 - train - INFO - Starting epoch 9...
2023-03-21 13:58:24,288 - train - INFO - Evaluating at epoch 9...
2023-03-21 13:58:31,569 - train - INFO - New best checkpoint at epoch 9...
2023-03-21 13:58:31,569 - train - INFO - Dev loss: 0.645, acc: 0.744, F1_weighted: 0.637, F1_macro: 0.214, F1_micro: 0.744, recall: 0.744, precision: 0.557, best_thresh: 0.500
2023-03-21 13:58:31,570 - train - INFO - Visualizing in TensorBoard...
2023-03-21 13:58:31,571 - train - INFO - Starting epoch 10...
2023-03-21 13:58:58,458 - train - INFO - Evaluating at epoch 10...
2023-03-21 13:59:05,972 - train - INFO - New best checkpoint at epoch 10...
2023-03-21 13:59:05,973 - train - INFO - Dev loss: 0.639, acc: 0.749, F1_weighted: 0.650, F1_macro: 0.266, F1_micro: 0.749, recall: 0.749, precision: 0.622, best_thresh: 0.500
2023-03-21 13:59:05,973 - train - INFO - Visualizing in TensorBoard...
2023-03-21 13:59:05,975 - train - INFO - Starting epoch 11...
2023-03-21 13:59:32,838 - train - INFO - Evaluating at epoch 11...
2023-03-21 13:59:40,324 - train - INFO - Dev loss: 0.636, acc: 0.758, F1_weighted: 0.683, F1_macro: 0.260, F1_micro: 0.758, recall: 0.758, precision: 0.673, best_thresh: 0.500
2023-03-21 13:59:40,325 - train - INFO - Visualizing in TensorBoard...
2023-03-21 13:59:40,326 - train - INFO - Starting epoch 12...
2023-03-21 14:00:07,499 - train - INFO - Evaluating at epoch 12...
2023-03-21 14:00:15,286 - train - INFO - Dev loss: 0.632, acc: 0.749, F1_weighted: 0.649, F1_macro: 0.225, F1_micro: 0.749, recall: 0.749, precision: 0.623, best_thresh: 0.500
2023-03-21 14:00:15,286 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:00:15,288 - train - INFO - Starting epoch 13...
2023-03-21 14:00:41,699 - train - INFO - Evaluating at epoch 13...
2023-03-21 14:00:49,103 - train - INFO - New best checkpoint at epoch 13...
2023-03-21 14:00:49,104 - train - INFO - Dev loss: 0.629, acc: 0.760, F1_weighted: 0.678, F1_macro: 0.295, F1_micro: 0.760, recall: 0.760, precision: 0.709, best_thresh: 0.500
2023-03-21 14:00:49,104 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:00:49,106 - train - INFO - Starting epoch 14...
2023-03-21 14:01:16,240 - train - INFO - Evaluating at epoch 14...
2023-03-21 14:01:24,129 - train - INFO - New best checkpoint at epoch 14...
2023-03-21 14:01:24,129 - train - INFO - Dev loss: 0.625, acc: 0.764, F1_weighted: 0.704, F1_macro: 0.393, F1_micro: 0.764, recall: 0.764, precision: 0.718, best_thresh: 0.500
2023-03-21 14:01:24,130 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:01:24,131 - train - INFO - Starting epoch 15...
2023-03-21 14:01:50,668 - train - INFO - Evaluating at epoch 15...
2023-03-21 14:01:58,079 - train - INFO - Dev loss: 0.623, acc: 0.769, F1_weighted: 0.704, F1_macro: 0.383, F1_micro: 0.769, recall: 0.769, precision: 0.730, best_thresh: 0.500
2023-03-21 14:01:58,079 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:01:58,081 - train - INFO - Starting epoch 16...
2023-03-21 14:02:24,752 - train - INFO - Evaluating at epoch 16...
2023-03-21 14:02:32,169 - train - INFO - New best checkpoint at epoch 16...
2023-03-21 14:02:32,170 - train - INFO - Dev loss: 0.625, acc: 0.751, F1_weighted: 0.705, F1_macro: 0.409, F1_micro: 0.751, recall: 0.751, precision: 0.699, best_thresh: 0.500
2023-03-21 14:02:32,170 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:02:32,171 - train - INFO - Starting epoch 17...
2023-03-21 14:02:58,732 - train - INFO - Evaluating at epoch 17...
2023-03-21 14:03:06,234 - train - INFO - Dev loss: 0.626, acc: 0.738, F1_weighted: 0.696, F1_macro: 0.401, F1_micro: 0.738, recall: 0.738, precision: 0.680, best_thresh: 0.500
2023-03-21 14:03:06,235 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:03:06,236 - train - INFO - Starting epoch 18...
2023-03-21 14:03:33,467 - train - INFO - Evaluating at epoch 18...
2023-03-21 14:03:40,839 - train - INFO - Dev loss: 0.630, acc: 0.727, F1_weighted: 0.686, F1_macro: 0.387, F1_micro: 0.727, recall: 0.727, precision: 0.667, best_thresh: 0.500
2023-03-21 14:03:40,839 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:03:40,841 - train - INFO - Starting epoch 19...
2023-03-21 14:04:07,386 - train - INFO - Evaluating at epoch 19...
2023-03-21 14:04:14,835 - train - INFO - Dev loss: 0.633, acc: 0.764, F1_weighted: 0.691, F1_macro: 0.387, F1_micro: 0.764, recall: 0.764, precision: 0.726, best_thresh: 0.500
2023-03-21 14:04:14,836 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:04:14,837 - train - INFO - Starting epoch 20...
2023-03-21 14:04:41,460 - train - INFO - Evaluating at epoch 20...
2023-03-21 14:04:49,243 - train - INFO - New best checkpoint at epoch 20...
2023-03-21 14:04:49,243 - train - INFO - Dev loss: 0.634, acc: 0.747, F1_weighted: 0.698, F1_macro: 0.437, F1_micro: 0.747, recall: 0.747, precision: 0.693, best_thresh: 0.500
2023-03-21 14:04:49,243 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:04:49,260 - train - INFO - Training DONE. Evaluating model...
2023-03-21 14:04:56,379 - train - INFO - DEV set prediction results: loss: 0.583, acc: 0.747, F1_weighted: 0.698, F1_macro: 0.437, F1_micro: 0.747, recall: 0.747, precision: 0.693, best_thresh: 0.500
2023-03-21 14:05:05,634 - train - INFO - TEST set prediction results: loss: 1.353, acc: 0.639, F1_weighted: 0.580, F1_macro: 0.429, F1_micro: 0.639, recall: 0.639, precision: 0.610, best_thresh: 0.500
