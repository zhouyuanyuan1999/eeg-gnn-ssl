2023-03-20 19:06:50,380 - train - INFO - Log directory: ./model_saved/train/train-06
2023-03-20 19:06:50,383 - train - INFO - Args: {
    "cl_decay_steps": 3000,
    "cuda": true,
    "data_augment": true,
    "dcgru_activation": "tanh",
    "do_train": true,
    "dropout": 0.5,
    "eval_every": 1,
    "filter_type": "dual_random_walk",
    "fine_tune": false,
    "graph_type": "individual",
    "input_dim": 100,
    "input_dir": "../tusz_resampled/",
    "l2_wd": 0.0005,
    "load_model_path": null,
    "lr_init": 0.0003,
    "max_diffusion_step": 2,
    "max_grad_norm": 5.0,
    "max_seq_len": 12,
    "maximize_metric": true,
    "metric_avg": "weighted",
    "metric_name": "F1_macro",
    "model_name": "dcrnn",
    "num_classes": 4,
    "num_epochs": 60,
    "num_nodes": 19,
    "num_rnn_layers": 2,
    "num_workers": 8,
    "output_dim": 100,
    "output_seq_len": 12,
    "patience": 5,
    "preproc_dir": null,
    "pretrained_num_rnn_layers": 3,
    "rand_seed": 123,
    "raw_data_dir": "../tusz_raw/",
    "rnn_units": 64,
    "save_dir": "./model_saved/train/train-06",
    "task": "classification",
    "test_batch_size": 128,
    "time_step_size": 1,
    "top_k": 3,
    "train_batch_size": 40,
    "use_curriculum_learning": false,
    "use_fft": true
}
2023-03-20 19:06:50,383 - train - INFO - Building dataset...
2023-03-20 19:07:16,089 - train - INFO - Building model...
2023-03-20 19:07:16,091 - train - INFO - Total number of trainable parameters: 280964
2023-03-20 19:07:17,200 - train - INFO - Saver will maximize F1_macro...
2023-03-20 19:07:17,201 - train - INFO - Training...
2023-03-20 19:07:17,201 - train - INFO - Starting epoch 1...
2023-03-20 19:07:42,842 - train - INFO - Evaluating at epoch 1...
2023-03-20 19:07:49,687 - train - INFO - New best checkpoint at epoch 1...
2023-03-20 19:07:49,688 - train - INFO - Dev loss: 0.667, acc: 0.744, F1_weighted: 0.635, F1_macro: 0.213, F1_micro: 0.744, recall: 0.744, precision: 0.554, best_thresh: 0.500
2023-03-20 19:07:49,688 - train - INFO - Visualizing in TensorBoard...
2023-03-20 19:07:49,689 - train - INFO - Starting epoch 2...
2023-03-20 19:08:14,860 - train - INFO - Evaluating at epoch 2...
2023-03-20 19:08:21,626 - train - INFO - New best checkpoint at epoch 2...
2023-03-20 19:08:21,626 - train - INFO - Dev loss: 0.640, acc: 0.744, F1_weighted: 0.635, F1_macro: 0.213, F1_micro: 0.744, recall: 0.744, precision: 0.554, best_thresh: 0.500
2023-03-20 19:08:21,627 - train - INFO - Visualizing in TensorBoard...
2023-03-20 19:08:21,627 - train - INFO - Starting epoch 3...
2023-03-20 19:08:46,925 - train - INFO - Evaluating at epoch 3...
2023-03-20 19:08:53,818 - train - INFO - New best checkpoint at epoch 3...
2023-03-20 19:08:53,819 - train - INFO - Dev loss: 0.621, acc: 0.753, F1_weighted: 0.664, F1_macro: 0.239, F1_micro: 0.753, recall: 0.753, precision: 0.650, best_thresh: 0.500
2023-03-20 19:08:53,819 - train - INFO - Visualizing in TensorBoard...
2023-03-20 19:08:53,821 - train - INFO - Starting epoch 4...
2023-03-20 19:09:19,524 - train - INFO - Evaluating at epoch 4...
2023-03-20 19:09:26,397 - train - INFO - New best checkpoint at epoch 4...
2023-03-20 19:09:26,397 - train - INFO - Dev loss: 0.615, acc: 0.760, F1_weighted: 0.679, F1_macro: 0.253, F1_micro: 0.760, recall: 0.760, precision: 0.675, best_thresh: 0.500
2023-03-20 19:09:26,397 - train - INFO - Visualizing in TensorBoard...
2023-03-20 19:09:26,398 - train - INFO - Starting epoch 5...
2023-03-20 19:09:51,972 - train - INFO - Evaluating at epoch 5...
2023-03-20 19:09:59,201 - train - INFO - Dev loss: 0.613, acc: 0.751, F1_weighted: 0.659, F1_macro: 0.232, F1_micro: 0.751, recall: 0.751, precision: 0.662, best_thresh: 0.500
2023-03-20 19:09:59,202 - train - INFO - Visualizing in TensorBoard...
2023-03-20 19:09:59,203 - train - INFO - Starting epoch 6...
2023-03-20 19:10:24,354 - train - INFO - Evaluating at epoch 6...
2023-03-20 19:10:31,802 - train - INFO - New best checkpoint at epoch 6...
2023-03-20 19:10:31,802 - train - INFO - Dev loss: 0.608, acc: 0.762, F1_weighted: 0.698, F1_macro: 0.277, F1_micro: 0.762, recall: 0.762, precision: 0.710, best_thresh: 0.500
2023-03-20 19:10:31,803 - train - INFO - Visualizing in TensorBoard...
2023-03-20 19:10:31,803 - train - INFO - Starting epoch 7...
2023-03-20 19:10:57,911 - train - INFO - Evaluating at epoch 7...
2023-03-20 19:11:04,773 - train - INFO - New best checkpoint at epoch 7...
2023-03-20 19:11:04,773 - train - INFO - Dev loss: 0.600, acc: 0.787, F1_weighted: 0.735, F1_macro: 0.351, F1_micro: 0.787, recall: 0.787, precision: 0.771, best_thresh: 0.500
2023-03-20 19:11:04,774 - train - INFO - Visualizing in TensorBoard...
2023-03-20 19:11:04,775 - train - INFO - Starting epoch 8...
2023-03-20 19:11:30,162 - train - INFO - Evaluating at epoch 8...
2023-03-20 19:11:37,178 - train - INFO - New best checkpoint at epoch 8...
2023-03-20 19:11:37,178 - train - INFO - Dev loss: 0.597, acc: 0.784, F1_weighted: 0.735, F1_macro: 0.371, F1_micro: 0.784, recall: 0.784, precision: 0.774, best_thresh: 0.500
2023-03-20 19:11:37,178 - train - INFO - Visualizing in TensorBoard...
2023-03-20 19:11:37,180 - train - INFO - Starting epoch 9...
2023-03-20 19:12:03,351 - train - INFO - Evaluating at epoch 9...
2023-03-20 19:12:10,196 - train - INFO - New best checkpoint at epoch 9...
2023-03-20 19:12:10,196 - train - INFO - Dev loss: 0.599, acc: 0.767, F1_weighted: 0.695, F1_macro: 0.371, F1_micro: 0.767, recall: 0.767, precision: 0.763, best_thresh: 0.500
2023-03-20 19:12:10,197 - train - INFO - Visualizing in TensorBoard...
2023-03-20 19:12:10,197 - train - INFO - Starting epoch 10...
2023-03-20 19:12:36,388 - train - INFO - Evaluating at epoch 10...
2023-03-20 19:12:43,457 - train - INFO - Dev loss: 0.605, acc: 0.747, F1_weighted: 0.647, F1_macro: 0.221, F1_micro: 0.747, recall: 0.747, precision: 0.777, best_thresh: 0.500
2023-03-20 19:12:43,458 - train - INFO - Visualizing in TensorBoard...
2023-03-20 19:12:43,459 - train - INFO - Starting epoch 11...
2023-03-20 19:13:09,446 - train - INFO - Evaluating at epoch 11...
2023-03-20 19:13:16,322 - train - INFO - New best checkpoint at epoch 11...
2023-03-20 19:13:16,322 - train - INFO - Dev loss: 0.603, acc: 0.780, F1_weighted: 0.724, F1_macro: 0.403, F1_micro: 0.780, recall: 0.780, precision: 0.750, best_thresh: 0.500
2023-03-20 19:13:16,322 - train - INFO - Visualizing in TensorBoard...
2023-03-20 19:13:16,323 - train - INFO - Starting epoch 12...
2023-03-20 19:13:41,998 - train - INFO - Evaluating at epoch 12...
2023-03-20 19:13:48,916 - train - INFO - New best checkpoint at epoch 12...
2023-03-20 19:13:48,917 - train - INFO - Dev loss: 0.604, acc: 0.762, F1_weighted: 0.702, F1_macro: 0.411, F1_micro: 0.762, recall: 0.762, precision: 0.715, best_thresh: 0.500
2023-03-20 19:13:48,917 - train - INFO - Visualizing in TensorBoard...
2023-03-20 19:13:48,918 - train - INFO - Starting epoch 13...
2023-03-20 19:14:14,014 - train - INFO - Evaluating at epoch 13...
2023-03-20 19:14:21,306 - train - INFO - New best checkpoint at epoch 13...
2023-03-20 19:14:21,307 - train - INFO - Dev loss: 0.605, acc: 0.773, F1_weighted: 0.722, F1_macro: 0.411, F1_micro: 0.773, recall: 0.773, precision: 0.739, best_thresh: 0.500
2023-03-20 19:14:21,307 - train - INFO - Visualizing in TensorBoard...
2023-03-20 19:14:21,308 - train - INFO - Starting epoch 14...
2023-03-20 19:14:46,307 - train - INFO - Evaluating at epoch 14...
2023-03-20 19:14:53,117 - train - INFO - New best checkpoint at epoch 14...
2023-03-20 19:14:53,118 - train - INFO - Dev loss: 0.604, acc: 0.782, F1_weighted: 0.742, F1_macro: 0.481, F1_micro: 0.782, recall: 0.782, precision: 0.742, best_thresh: 0.500
2023-03-20 19:14:53,118 - train - INFO - Visualizing in TensorBoard...
2023-03-20 19:14:53,119 - train - INFO - Starting epoch 15...
2023-03-20 19:15:18,074 - train - INFO - Evaluating at epoch 15...
2023-03-20 19:15:24,851 - train - INFO - Dev loss: 0.605, acc: 0.778, F1_weighted: 0.722, F1_macro: 0.403, F1_micro: 0.778, recall: 0.778, precision: 0.763, best_thresh: 0.500
2023-03-20 19:15:24,852 - train - INFO - Visualizing in TensorBoard...
2023-03-20 19:15:24,853 - train - INFO - Starting epoch 16...
2023-03-20 19:15:50,292 - train - INFO - Evaluating at epoch 16...
2023-03-20 19:15:57,095 - train - INFO - New best checkpoint at epoch 16...
2023-03-20 19:15:57,096 - train - INFO - Dev loss: 0.605, acc: 0.787, F1_weighted: 0.745, F1_macro: 0.496, F1_micro: 0.787, recall: 0.787, precision: 0.747, best_thresh: 0.500
2023-03-20 19:15:57,096 - train - INFO - Visualizing in TensorBoard...
2023-03-20 19:15:57,097 - train - INFO - Starting epoch 17...
2023-03-20 19:16:22,937 - train - INFO - Evaluating at epoch 17...
2023-03-20 19:16:29,929 - train - INFO - Dev loss: 0.607, acc: 0.769, F1_weighted: 0.718, F1_macro: 0.432, F1_micro: 0.769, recall: 0.769, precision: 0.732, best_thresh: 0.500
2023-03-20 19:16:29,929 - train - INFO - Visualizing in TensorBoard...
2023-03-20 19:16:29,930 - train - INFO - Starting epoch 18...
2023-03-20 19:16:55,341 - train - INFO - Evaluating at epoch 18...
2023-03-20 19:17:02,664 - train - INFO - New best checkpoint at epoch 18...
2023-03-20 19:17:02,664 - train - INFO - Dev loss: 0.610, acc: 0.773, F1_weighted: 0.716, F1_macro: 0.497, F1_micro: 0.773, recall: 0.773, precision: 0.721, best_thresh: 0.500
2023-03-20 19:17:02,664 - train - INFO - Visualizing in TensorBoard...
2023-03-20 19:17:02,667 - train - INFO - Starting epoch 19...
2023-03-20 19:17:27,964 - train - INFO - Evaluating at epoch 19...
2023-03-20 19:17:35,254 - train - INFO - New best checkpoint at epoch 19...
2023-03-20 19:17:35,254 - train - INFO - Dev loss: 0.608, acc: 0.764, F1_weighted: 0.755, F1_macro: 0.539, F1_micro: 0.764, recall: 0.764, precision: 0.750, best_thresh: 0.500
2023-03-20 19:17:35,254 - train - INFO - Visualizing in TensorBoard...
2023-03-20 19:17:35,256 - train - INFO - Starting epoch 20...
2023-03-20 19:18:00,840 - train - INFO - Evaluating at epoch 20...
2023-03-20 19:18:07,812 - train - INFO - Dev loss: 0.610, acc: 0.764, F1_weighted: 0.714, F1_macro: 0.503, F1_micro: 0.764, recall: 0.764, precision: 0.706, best_thresh: 0.500
2023-03-20 19:18:07,812 - train - INFO - Visualizing in TensorBoard...
2023-03-20 19:18:07,813 - train - INFO - Starting epoch 21...
2023-03-20 19:18:33,395 - train - INFO - Evaluating at epoch 21...
2023-03-20 19:18:40,220 - train - INFO - Dev loss: 0.614, acc: 0.740, F1_weighted: 0.714, F1_macro: 0.514, F1_micro: 0.740, recall: 0.740, precision: 0.699, best_thresh: 0.500
2023-03-20 19:18:40,220 - train - INFO - Visualizing in TensorBoard...
2023-03-20 19:18:40,222 - train - INFO - Starting epoch 22...
2023-03-20 19:19:06,138 - train - INFO - Evaluating at epoch 22...
2023-03-20 19:19:13,022 - train - INFO - Dev loss: 0.615, acc: 0.773, F1_weighted: 0.732, F1_macro: 0.516, F1_micro: 0.773, recall: 0.773, precision: 0.723, best_thresh: 0.500
2023-03-20 19:19:13,022 - train - INFO - Visualizing in TensorBoard...
2023-03-20 19:19:13,023 - train - INFO - Starting epoch 23...
2023-03-20 19:19:38,722 - train - INFO - Evaluating at epoch 23...
2023-03-20 19:19:45,575 - train - INFO - Dev loss: 0.619, acc: 0.722, F1_weighted: 0.689, F1_macro: 0.492, F1_micro: 0.722, recall: 0.722, precision: 0.668, best_thresh: 0.500
2023-03-20 19:19:45,576 - train - INFO - Visualizing in TensorBoard...
2023-03-20 19:19:45,576 - train - INFO - Starting epoch 24...
2023-03-20 19:20:11,154 - train - INFO - Evaluating at epoch 24...
2023-03-20 19:20:18,362 - train - INFO - Dev loss: 0.625, acc: 0.718, F1_weighted: 0.677, F1_macro: 0.481, F1_micro: 0.718, recall: 0.718, precision: 0.653, best_thresh: 0.500
2023-03-20 19:20:18,362 - train - INFO - Visualizing in TensorBoard...
2023-03-20 19:20:18,387 - train - INFO - Training DONE. Evaluating model...
2023-03-20 19:20:24,866 - train - INFO - DEV set prediction results: loss: 0.586, acc: 0.764, F1_weighted: 0.755, F1_macro: 0.539, F1_micro: 0.764, recall: 0.764, precision: 0.750, best_thresh: 0.500
2023-03-20 19:20:33,404 - train - INFO - TEST set prediction results: loss: 0.547, acc: 0.795, F1_weighted: 0.795, F1_macro: 0.756, F1_micro: 0.795, recall: 0.795, precision: 0.799, best_thresh: 0.500
