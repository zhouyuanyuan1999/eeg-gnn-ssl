2023-03-21 14:07:24,512 - train - INFO - Log directory: ./model_saved/train/train-06
2023-03-21 14:07:24,515 - train - INFO - Args: {
    "cl_decay_steps": 3000,
    "cuda": true,
    "data_augment": true,
    "dcgru_activation": "tanh",
    "do_train": true,
    "dropout": 0.5,
    "eval_every": 1,
    "filter_type": "dual_random_walk",
    "fine_tune": false,
    "graph_type": "individual",
    "input_dim": 200,
    "input_dir": "../tusz_resampled/",
    "l2_wd": 0.0005,
    "load_model_path": null,
    "lr_init": 0.0003,
    "max_diffusion_step": 2,
    "max_grad_norm": 5.0,
    "max_seq_len": 12,
    "maximize_metric": true,
    "metric_avg": "weighted",
    "metric_name": "F1_macro",
    "model_name": "dcrnn",
    "num_classes": 4,
    "num_epochs": 60,
    "num_nodes": 19,
    "num_rnn_layers": 2,
    "num_workers": 8,
    "output_dim": 100,
    "output_seq_len": 12,
    "patience": 5,
    "preproc_dir": null,
    "preprocess": "raw_theta",
    "pretrained_num_rnn_layers": 3,
    "rand_seed": 123,
    "raw_data_dir": "../tusz_raw/",
    "rnn_units": 64,
    "save_dir": "./model_saved/train/train-06",
    "task": "classification",
    "test_batch_size": 128,
    "time_step_size": 1,
    "top_k": 3,
    "train_batch_size": 40,
    "use_curriculum_learning": false
}
2023-03-21 14:07:24,515 - train - INFO - Building dataset...
2023-03-21 14:07:49,551 - train - INFO - Building model...
2023-03-21 14:07:49,554 - train - INFO - Total number of trainable parameters: 376964
2023-03-21 14:07:50,659 - train - INFO - Saver will maximize F1_macro...
2023-03-21 14:07:50,660 - train - INFO - Training...
2023-03-21 14:07:50,660 - train - INFO - Starting epoch 1...
2023-03-21 14:08:17,791 - train - INFO - Evaluating at epoch 1...
2023-03-21 14:08:25,587 - train - INFO - New best checkpoint at epoch 1...
2023-03-21 14:08:25,588 - train - INFO - Dev loss: 0.750, acc: 0.744, F1_weighted: 0.635, F1_macro: 0.213, F1_micro: 0.744, recall: 0.744, precision: 0.554, best_thresh: 0.500
2023-03-21 14:08:25,588 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:08:25,589 - train - INFO - Starting epoch 2...
2023-03-21 14:08:52,524 - train - INFO - Evaluating at epoch 2...
2023-03-21 14:09:00,586 - train - INFO - New best checkpoint at epoch 2...
2023-03-21 14:09:00,587 - train - INFO - Dev loss: 0.719, acc: 0.744, F1_weighted: 0.635, F1_macro: 0.213, F1_micro: 0.744, recall: 0.744, precision: 0.554, best_thresh: 0.500
2023-03-21 14:09:00,587 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:09:00,588 - train - INFO - Starting epoch 3...
2023-03-21 14:09:28,219 - train - INFO - Evaluating at epoch 3...
2023-03-21 14:09:36,197 - train - INFO - New best checkpoint at epoch 3...
2023-03-21 14:09:36,197 - train - INFO - Dev loss: 0.692, acc: 0.744, F1_weighted: 0.646, F1_macro: 0.224, F1_micro: 0.744, recall: 0.744, precision: 0.614, best_thresh: 0.500
2023-03-21 14:09:36,198 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:09:36,198 - train - INFO - Starting epoch 4...
2023-03-21 14:10:03,345 - train - INFO - Evaluating at epoch 4...
2023-03-21 14:10:10,947 - train - INFO - New best checkpoint at epoch 4...
2023-03-21 14:10:10,947 - train - INFO - Dev loss: 0.668, acc: 0.760, F1_weighted: 0.684, F1_macro: 0.260, F1_micro: 0.760, recall: 0.760, precision: 0.673, best_thresh: 0.500
2023-03-21 14:10:10,947 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:10:10,948 - train - INFO - Starting epoch 5...
2023-03-21 14:10:39,222 - train - INFO - Evaluating at epoch 5...
2023-03-21 14:10:46,685 - train - INFO - Dev loss: 0.660, acc: 0.758, F1_weighted: 0.677, F1_macro: 0.252, F1_micro: 0.758, recall: 0.758, precision: 0.664, best_thresh: 0.500
2023-03-21 14:10:46,686 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:10:46,686 - train - INFO - Starting epoch 6...
2023-03-21 14:11:14,393 - train - INFO - Evaluating at epoch 6...
2023-03-21 14:11:21,912 - train - INFO - New best checkpoint at epoch 6...
2023-03-21 14:11:21,912 - train - INFO - Dev loss: 0.645, acc: 0.778, F1_weighted: 0.716, F1_macro: 0.292, F1_micro: 0.778, recall: 0.778, precision: 0.715, best_thresh: 0.500
2023-03-21 14:11:21,912 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:11:21,914 - train - INFO - Starting epoch 7...
2023-03-21 14:11:49,260 - train - INFO - Evaluating at epoch 7...
2023-03-21 14:11:57,272 - train - INFO - Dev loss: 0.638, acc: 0.769, F1_weighted: 0.700, F1_macro: 0.277, F1_micro: 0.769, recall: 0.769, precision: 0.697, best_thresh: 0.500
2023-03-21 14:11:57,272 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:11:57,274 - train - INFO - Starting epoch 8...
2023-03-21 14:12:24,706 - train - INFO - Evaluating at epoch 8...
2023-03-21 14:12:32,077 - train - INFO - New best checkpoint at epoch 8...
2023-03-21 14:12:32,078 - train - INFO - Dev loss: 0.625, acc: 0.804, F1_weighted: 0.761, F1_macro: 0.335, F1_micro: 0.804, recall: 0.804, precision: 0.751, best_thresh: 0.500
2023-03-21 14:12:32,078 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:12:32,079 - train - INFO - Starting epoch 9...
2023-03-21 14:12:59,012 - train - INFO - Evaluating at epoch 9...
2023-03-21 14:13:06,405 - train - INFO - New best checkpoint at epoch 9...
2023-03-21 14:13:06,406 - train - INFO - Dev loss: 0.619, acc: 0.773, F1_weighted: 0.711, F1_macro: 0.364, F1_micro: 0.773, recall: 0.773, precision: 0.728, best_thresh: 0.500
2023-03-21 14:13:06,406 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:13:06,408 - train - INFO - Starting epoch 10...
2023-03-21 14:13:33,066 - train - INFO - Evaluating at epoch 10...
2023-03-21 14:13:40,522 - train - INFO - Dev loss: 0.619, acc: 0.764, F1_weighted: 0.695, F1_macro: 0.348, F1_micro: 0.764, recall: 0.764, precision: 0.706, best_thresh: 0.500
2023-03-21 14:13:40,522 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:13:40,523 - train - INFO - Starting epoch 11...
2023-03-21 14:14:07,245 - train - INFO - Evaluating at epoch 11...
2023-03-21 14:14:14,867 - train - INFO - New best checkpoint at epoch 11...
2023-03-21 14:14:14,867 - train - INFO - Dev loss: 0.614, acc: 0.778, F1_weighted: 0.720, F1_macro: 0.371, F1_micro: 0.778, recall: 0.778, precision: 0.729, best_thresh: 0.500
2023-03-21 14:14:14,868 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:14:14,869 - train - INFO - Starting epoch 12...
2023-03-21 14:14:41,670 - train - INFO - Evaluating at epoch 12...
2023-03-21 14:14:49,254 - train - INFO - New best checkpoint at epoch 12...
2023-03-21 14:14:49,254 - train - INFO - Dev loss: 0.614, acc: 0.769, F1_weighted: 0.700, F1_macro: 0.408, F1_micro: 0.769, recall: 0.769, precision: 0.722, best_thresh: 0.500
2023-03-21 14:14:49,254 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:14:49,256 - train - INFO - Starting epoch 13...
2023-03-21 14:15:16,036 - train - INFO - Evaluating at epoch 13...
2023-03-21 14:15:23,404 - train - INFO - Dev loss: 0.613, acc: 0.767, F1_weighted: 0.696, F1_macro: 0.381, F1_micro: 0.767, recall: 0.767, precision: 0.726, best_thresh: 0.500
2023-03-21 14:15:23,404 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:15:23,405 - train - INFO - Starting epoch 14...
2023-03-21 14:15:50,634 - train - INFO - Evaluating at epoch 14...
2023-03-21 14:15:58,093 - train - INFO - New best checkpoint at epoch 14...
2023-03-21 14:15:58,094 - train - INFO - Dev loss: 0.610, acc: 0.791, F1_weighted: 0.740, F1_macro: 0.423, F1_micro: 0.791, recall: 0.791, precision: 0.761, best_thresh: 0.500
2023-03-21 14:15:58,094 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:15:58,096 - train - INFO - Starting epoch 15...
2023-03-21 14:16:25,126 - train - INFO - Evaluating at epoch 15...
2023-03-21 14:16:32,742 - train - INFO - New best checkpoint at epoch 15...
2023-03-21 14:16:32,742 - train - INFO - Dev loss: 0.606, acc: 0.798, F1_weighted: 0.751, F1_macro: 0.433, F1_micro: 0.798, recall: 0.798, precision: 0.768, best_thresh: 0.500
2023-03-21 14:16:32,742 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:16:32,744 - train - INFO - Starting epoch 16...
2023-03-21 14:16:59,815 - train - INFO - Evaluating at epoch 16...
2023-03-21 14:17:07,163 - train - INFO - Dev loss: 0.601, acc: 0.802, F1_weighted: 0.761, F1_macro: 0.414, F1_micro: 0.802, recall: 0.802, precision: 0.772, best_thresh: 0.500
2023-03-21 14:17:07,164 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:17:07,165 - train - INFO - Starting epoch 17...
2023-03-21 14:17:33,595 - train - INFO - Evaluating at epoch 17...
2023-03-21 14:17:41,139 - train - INFO - New best checkpoint at epoch 17...
2023-03-21 14:17:41,140 - train - INFO - Dev loss: 0.600, acc: 0.791, F1_weighted: 0.742, F1_macro: 0.440, F1_micro: 0.791, recall: 0.791, precision: 0.755, best_thresh: 0.500
2023-03-21 14:17:41,140 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:17:41,142 - train - INFO - Starting epoch 18...
2023-03-21 14:18:07,749 - train - INFO - Evaluating at epoch 18...
2023-03-21 14:18:15,011 - train - INFO - New best checkpoint at epoch 18...
2023-03-21 14:18:15,012 - train - INFO - Dev loss: 0.599, acc: 0.798, F1_weighted: 0.750, F1_macro: 0.471, F1_micro: 0.798, recall: 0.798, precision: 0.774, best_thresh: 0.500
2023-03-21 14:18:15,012 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:18:15,013 - train - INFO - Starting epoch 19...
2023-03-21 14:18:41,629 - train - INFO - Evaluating at epoch 19...
2023-03-21 14:18:49,220 - train - INFO - New best checkpoint at epoch 19...
2023-03-21 14:18:49,221 - train - INFO - Dev loss: 0.596, acc: 0.811, F1_weighted: 0.772, F1_macro: 0.477, F1_micro: 0.811, recall: 0.811, precision: 0.785, best_thresh: 0.500
2023-03-21 14:18:49,221 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:18:49,222 - train - INFO - Starting epoch 20...
2023-03-21 14:19:16,353 - train - INFO - Evaluating at epoch 20...
2023-03-21 14:19:23,563 - train - INFO - New best checkpoint at epoch 20...
2023-03-21 14:19:23,564 - train - INFO - Dev loss: 0.595, acc: 0.804, F1_weighted: 0.756, F1_macro: 0.483, F1_micro: 0.804, recall: 0.804, precision: 0.789, best_thresh: 0.500
2023-03-21 14:19:23,564 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:19:23,566 - train - INFO - Starting epoch 21...
2023-03-21 14:19:50,554 - train - INFO - Evaluating at epoch 21...
2023-03-21 14:19:58,008 - train - INFO - New best checkpoint at epoch 21...
2023-03-21 14:19:58,008 - train - INFO - Dev loss: 0.592, acc: 0.804, F1_weighted: 0.770, F1_macro: 0.490, F1_micro: 0.804, recall: 0.804, precision: 0.770, best_thresh: 0.500
2023-03-21 14:19:58,009 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:19:58,009 - train - INFO - Starting epoch 22...
2023-03-21 14:20:25,247 - train - INFO - Evaluating at epoch 22...
2023-03-21 14:20:32,824 - train - INFO - New best checkpoint at epoch 22...
2023-03-21 14:20:32,824 - train - INFO - Dev loss: 0.590, acc: 0.816, F1_weighted: 0.784, F1_macro: 0.502, F1_micro: 0.816, recall: 0.816, precision: 0.785, best_thresh: 0.500
2023-03-21 14:20:32,824 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:20:32,826 - train - INFO - Starting epoch 23...
2023-03-21 14:20:59,305 - train - INFO - Evaluating at epoch 23...
2023-03-21 14:21:06,686 - train - INFO - Dev loss: 0.589, acc: 0.804, F1_weighted: 0.758, F1_macro: 0.485, F1_micro: 0.804, recall: 0.804, precision: 0.785, best_thresh: 0.500
2023-03-21 14:21:06,686 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:21:06,687 - train - INFO - Starting epoch 24...
2023-03-21 14:21:33,348 - train - INFO - Evaluating at epoch 24...
2023-03-21 14:21:40,698 - train - INFO - Dev loss: 0.588, acc: 0.804, F1_weighted: 0.768, F1_macro: 0.468, F1_micro: 0.804, recall: 0.804, precision: 0.777, best_thresh: 0.500
2023-03-21 14:21:40,699 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:21:40,700 - train - INFO - Starting epoch 25...
2023-03-21 14:22:07,851 - train - INFO - Evaluating at epoch 25...
2023-03-21 14:22:15,854 - train - INFO - Dev loss: 0.590, acc: 0.784, F1_weighted: 0.727, F1_macro: 0.410, F1_micro: 0.784, recall: 0.784, precision: 0.759, best_thresh: 0.500
2023-03-21 14:22:15,854 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:22:15,855 - train - INFO - Starting epoch 26...
2023-03-21 14:22:43,394 - train - INFO - Evaluating at epoch 26...
2023-03-21 14:22:50,654 - train - INFO - Dev loss: 0.593, acc: 0.780, F1_weighted: 0.715, F1_macro: 0.420, F1_micro: 0.780, recall: 0.780, precision: 0.759, best_thresh: 0.500
2023-03-21 14:22:50,655 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:22:50,656 - train - INFO - Starting epoch 27...
2023-03-21 14:23:17,207 - train - INFO - Evaluating at epoch 27...
2023-03-21 14:23:24,516 - train - INFO - Dev loss: 0.594, acc: 0.787, F1_weighted: 0.742, F1_macro: 0.420, F1_micro: 0.787, recall: 0.787, precision: 0.750, best_thresh: 0.500
2023-03-21 14:23:24,516 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:23:24,518 - train - INFO - Starting epoch 28...
2023-03-21 14:23:51,790 - train - INFO - Evaluating at epoch 28...
2023-03-21 14:23:59,078 - train - INFO - Dev loss: 0.593, acc: 0.800, F1_weighted: 0.761, F1_macro: 0.472, F1_micro: 0.800, recall: 0.800, precision: 0.775, best_thresh: 0.500
2023-03-21 14:23:59,079 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:23:59,081 - train - INFO - Starting epoch 29...
2023-03-21 14:24:25,955 - train - INFO - Evaluating at epoch 29...
2023-03-21 14:24:33,221 - train - INFO - Dev loss: 0.592, acc: 0.804, F1_weighted: 0.769, F1_macro: 0.479, F1_micro: 0.804, recall: 0.804, precision: 0.775, best_thresh: 0.500
2023-03-21 14:24:33,222 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:24:33,223 - train - INFO - Starting epoch 30...
2023-03-21 14:25:00,370 - train - INFO - Evaluating at epoch 30...
2023-03-21 14:25:08,613 - train - INFO - Dev loss: 0.592, acc: 0.796, F1_weighted: 0.766, F1_macro: 0.464, F1_micro: 0.796, recall: 0.796, precision: 0.763, best_thresh: 0.500
2023-03-21 14:25:08,614 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:25:08,615 - train - INFO - Starting epoch 31...
2023-03-21 14:25:37,602 - train - INFO - Evaluating at epoch 31...
2023-03-21 14:25:45,121 - train - INFO - Dev loss: 0.592, acc: 0.791, F1_weighted: 0.763, F1_macro: 0.496, F1_micro: 0.791, recall: 0.791, precision: 0.758, best_thresh: 0.500
2023-03-21 14:25:45,122 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:25:45,123 - train - INFO - Starting epoch 32...
2023-03-21 14:26:11,645 - train - INFO - Evaluating at epoch 32...
2023-03-21 14:26:19,034 - train - INFO - Dev loss: 0.594, acc: 0.784, F1_weighted: 0.729, F1_macro: 0.447, F1_micro: 0.784, recall: 0.784, precision: 0.758, best_thresh: 0.500
2023-03-21 14:26:19,034 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:26:19,036 - train - INFO - Starting epoch 33...
2023-03-21 14:26:45,522 - train - INFO - Evaluating at epoch 33...
2023-03-21 14:26:52,786 - train - INFO - Dev loss: 0.594, acc: 0.791, F1_weighted: 0.766, F1_macro: 0.489, F1_micro: 0.791, recall: 0.791, precision: 0.757, best_thresh: 0.500
2023-03-21 14:26:52,787 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:26:52,788 - train - INFO - Starting epoch 34...
2023-03-21 14:27:19,522 - train - INFO - Evaluating at epoch 34...
2023-03-21 14:27:26,794 - train - INFO - Dev loss: 0.596, acc: 0.784, F1_weighted: 0.745, F1_macro: 0.496, F1_micro: 0.784, recall: 0.784, precision: 0.749, best_thresh: 0.500
2023-03-21 14:27:26,794 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:27:26,796 - train - INFO - Starting epoch 35...
2023-03-21 14:27:53,320 - train - INFO - Evaluating at epoch 35...
2023-03-21 14:28:00,587 - train - INFO - Dev loss: 0.598, acc: 0.789, F1_weighted: 0.744, F1_macro: 0.473, F1_micro: 0.789, recall: 0.789, precision: 0.756, best_thresh: 0.500
2023-03-21 14:28:00,587 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:28:00,589 - train - INFO - Starting epoch 36...
2023-03-21 14:28:27,731 - train - INFO - Evaluating at epoch 36...
2023-03-21 14:28:35,017 - train - INFO - New best checkpoint at epoch 36...
2023-03-21 14:28:35,017 - train - INFO - Dev loss: 0.599, acc: 0.784, F1_weighted: 0.750, F1_macro: 0.502, F1_micro: 0.784, recall: 0.784, precision: 0.749, best_thresh: 0.500
2023-03-21 14:28:35,018 - train - INFO - Visualizing in TensorBoard...
2023-03-21 14:28:35,036 - train - INFO - Training DONE. Evaluating model...
2023-03-21 14:28:41,522 - train - INFO - DEV set prediction results: loss: 0.698, acc: 0.784, F1_weighted: 0.750, F1_macro: 0.502, F1_micro: 0.784, recall: 0.784, precision: 0.749, best_thresh: 0.500
2023-03-21 14:28:51,220 - train - INFO - TEST set prediction results: loss: 1.076, acc: 0.633, F1_weighted: 0.595, F1_macro: 0.482, F1_micro: 0.633, recall: 0.633, precision: 0.625, best_thresh: 0.500
